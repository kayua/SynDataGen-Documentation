<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>AdversarialAlgorithm API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>



            <h3>
                <img src="Icon/Logo.png" alt="API Icon" width="54" height="54" style="vertical-align: middle; margin-right: 8px;">
                Synthetic Ocean AI</h3>
            <h4> Documentation</h4>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AdversarialAlgorithm">AdversarialAlgorithm</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.__init__">AdversarialAlgorithm</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.compile">compile</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.train_step">train_step</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.get_samples">get_samples</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.save_model">save_model</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.load_models">load_models</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_generator">set_generator</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_discriminator">set_discriminator</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_latent_dimension">set_latent_dimension</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_optimizer_generator">set_optimizer_generator</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_optimizer_discriminator">set_optimizer_discriminator</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_loss_generator">set_loss_generator</a>
                        </li>
                        <li>
                                <a class="function" href="#AdversarialAlgorithm.set_loss_discriminator">set_loss_discriminator</a>
                        </li>
                </ul>

            </li>
    </ul>




</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
AdversarialAlgorithm    </h1>

                
                        <input id="mod-AdversarialAlgorithm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-AdversarialAlgorithm-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Kayu√£ Oleques Paim&#39;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="n">__email__</span> <span class="o">=</span> <span class="s1">&#39;kayuaolequesp@gmail.com.br&#39;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{1}</span><span class="s1">.</span><span class="si">{0}</span><span class="s1">.</span><span class="si">{0}</span><span class="s1">&#39;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="n">__initial_data__</span> <span class="o">=</span> <span class="s1">&#39;2022/06/01&#39;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="n">__last_update__</span> <span class="o">=</span> <span class="s1">&#39;2023/08/03&#39;</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="n">__credits__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;unknown&#39;</span><span class="p">]</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="k">try</span><span class="p">:</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>    <span class="kn">import</span> <span class="nn">numpy</span>  
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>    <span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>    <span class="kn">import</span> <span class="nn">tensorflow</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>    <span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">model_from_json</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="kn">from</span> <span class="nn">tensorflow.keras.losses</span> <span class="kn">import</span> <span class="n">BinaryCrossentropy</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="k">class</span> <span class="nc">AdversarialAlgorithm</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    Implements an adversarial training algorithm, typically used in Generative Adversarial Networks (GANs).</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    This class performs adversarial training by utilizing a generator and a discriminator,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    optimizing the generator to produce realistic data while training the discriminator to differentiate</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    between real and fake data.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    The concept of Generative Adversarial Networks was introduced by Ian Goodfellow and his collaborators in</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    the following paper:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., . . . Bengio, Y. (2014).</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    Generative Adversarial Nets. In Advances in Neural Information Processing Systems (NeurIPS).</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    Attributes:</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        @generator_model (Model):</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">            The generator model.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        @discriminator_model (Model):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">            The discriminator model.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        @latent_dimension (int):</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">            Dimensionality of the latent space.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        @loss_generator (function):</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            Loss function for the generator.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        @loss_discriminator (function):</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">            Loss function for the discriminator.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        @file_name_discriminator (str):</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">            Filename for saving the discriminator model.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        @file_name_generator (str):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">            Filename for saving the generator model.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        @models_saved_path (str):</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">            Path where models will be saved.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        @latent_mean_distribution (float):</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">            Mean of the latent noise distribution.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        @latent_stander_deviation (float):</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">            Standard deviation of the latent noise distribution.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        @smoothing_rate (float):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">            Smoothing rate applied to discriminator labels.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    Example:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        &gt;&gt;&gt; generator_model = build_generator(latent_dimension=100)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        ...     discriminator_model = build_discriminator()</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        ...     adversarial_algorithm = AdversarialAlgorithm(</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        ...     generator_model=generator_model,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        ...     discriminator_model=discriminator_model,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        ...     latent_dimension=100,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        ...     loss_generator=tf.keras.losses.BinaryCrossentropy(),</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        ...     loss_discriminator=tf.keras.losses.BinaryCrossentropy(),</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        ...     file_name_discriminator=&quot;discriminator.h5&quot;,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        ...     file_name_generator=&quot;generator.h5&quot;,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        ...     models_saved_path=&quot;./models/&quot;,</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        ...     latent_mean_distribution=0.0,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        ...     latent_stander_deviation=1.0,</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        ...     smoothing_rate=0.1</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        ...     )</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        ...     adversarial_algorithm.compile(</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        ...     optimizer_generator=tf.keras.optimizers.Adam(learning_rate=0.0002),</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">        ...     optimizer_discriminator=tf.keras.optimizers.Adam(learning_rate=0.0002)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        ...     )</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        # Train the model</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        &gt;&gt;&gt; adversarial_algorithm.fit(train_dataset)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator_model</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>                 <span class="n">discriminator_model</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                 <span class="n">latent_dimension</span><span class="p">,</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>                 <span class="n">loss_generator</span><span class="p">,</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>                 <span class="n">loss_discriminator</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                 <span class="n">file_name_discriminator</span><span class="p">,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>                 <span class="n">file_name_generator</span><span class="p">,</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                 <span class="n">models_saved_path</span><span class="p">,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                 <span class="n">latent_mean_distribution</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                 <span class="n">latent_stander_deviation</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                 <span class="n">smoothing_rate</span><span class="p">,</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                 <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Initializes the adversarial algorithm with the specified generator, discriminator, and other configurations.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        Args:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">            @generator_model (Model):</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">                The generator model.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">            @discriminator_model (Model):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">                The discriminator model.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">            @latent_dimension (int):</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">                Latent space dimension.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">            @loss_generator (function):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">                Generator&#39;s loss function.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">            @loss_discriminator (function):</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">                Discriminator&#39;s loss function.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">            @file_name_discriminator (str):</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">                Filename for discriminator model.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">            @file_name_generator (str):</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">                Filename for generator model.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">            @models_saved_path (str):</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">                Path for saving models.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">            @latent_mean_distribution (float):</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">                Mean of the latent noise distribution.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">            @latent_stander_deviation (float):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">                Standard deviation of the latent noise.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">            @smoothing_rate (float):</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">                Label smoothing rate.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">            @*args, **kwargs:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">                Additional arguments.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="n">latent_dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent dimension must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_discriminator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_discriminator</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Discriminator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_generator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_generator</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Generator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">models_saved_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">models_saved_path</span><span class="p">:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Models saved path must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_mean_distribution</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent mean distribution must be a number.&quot;</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_stander_deviation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be a number.&quot;</span><span class="p">)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="n">latent_stander_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">smoothing_rate</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Smoothing rate must be between 0 and 1.&quot;</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator_model</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator_model</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_smoothing_rate</span> <span class="o">=</span> <span class="n">smoothing_rate</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span> <span class="o">=</span> <span class="n">latent_mean_distribution</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span> <span class="o">=</span> <span class="n">latent_stander_deviation</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">=</span> <span class="n">file_name_discriminator</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">=</span> <span class="n">file_name_generator</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span> <span class="o">=</span> <span class="n">models_saved_path</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        Compiles the adversarial algorithm by setting optimizers and loss functions for both generator and discriminator.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        Args:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">            optimizer_generator (Optimizer): Optimizer for the generator.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            optimizer_discriminator (Optimizer): Optimizer for the discriminator.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">            loss_generator (function): Generator&#39;s loss function.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">            loss_discriminator (function): Discriminator&#39;s loss function.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            *args, **kwargs: Additional arguments.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="nd">@tensorflow</span><span class="o">.</span><span class="n">function</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        Performs a single training step for both generator and discriminator.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        This function is decorated with @tensorflow.function to optimize graph execution.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">        Args:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">            batch (tuple): A tuple containing real features (input data) and their corresponding labels.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        Returns:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">            dict: A dictionary containing the loss values for both generator (loss_g) and discriminator (loss_d).</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="c1"># Unpack the batch into real features and real labels</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">batch</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="c1"># Get the current batch size (number of samples in this batch)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">real_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="c1"># Expand the label tensor to match the expected shape (add a new axis at the end)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">real_samples_label</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="c1"># Sample random noise vectors (latent space) for the generator input</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="c1"># Use the generator to create synthetic (fake) features using noise and real labels (conditioning)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="c1"># Start discriminator training within a gradient tape context to track gradients</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">discriminator_gradient</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="c1"># Get discriminator prediction on real samples (real features + real labels)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>            <span class="n">label_predicted_real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>            <span class="c1"># Get discriminator prediction on synthetic (fake) samples (synthetic features + real labels)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="n">label_predicted_synthetic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="c1"># Concatenate predictions for real and synthetic samples into a single tensor</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="n">label_predicted_all_samples</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">label_predicted_real</span><span class="p">,</span> <span class="n">label_predicted_synthetic</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="c1"># Create the ground-truth labels for the discriminator</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="c1"># Real samples should be labeled as 0, synthetic samples as 1</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">list_all_labels_predicted</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">),</span>  <span class="c1"># Real labels = 0</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">)</span>  <span class="c1"># Fake labels = 1</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="p">]</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_all_labels_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="c1"># Label smoothing for regularization</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="c1"># Add random noise to real labels (smooth them slightly downwards)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">smooth_tensor_real_data</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">))</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="c1"># Add random noise to fake labels (smooth them slightly upwards)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">smooth_tensor_synthetic_data</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">))</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="c1"># Combine smoothed noise into the label tensor</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">+=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                <span class="p">[</span><span class="n">smooth_tensor_real_data</span><span class="p">,</span> <span class="n">smooth_tensor_synthetic_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="c1"># Compute the discriminator loss comparing predicted labels to (smoothed) ground-truth labels</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="n">loss_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span><span class="p">(</span><span class="n">tensor_labels_predicted</span><span class="p">,</span> <span class="n">label_predicted_all_samples</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="c1"># Compute gradients of the discriminator loss with respect to discriminator trainable weights</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">discriminator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="c1"># Apply the computed gradients to update discriminator weights</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="c1"># Start generator training within a gradient tape context to track gradients</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">generator_gradient</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="c1"># Generate synthetic samples using the generator (in training mode)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="c1"># Get discriminator predictions for the synthetic samples (real labels used for conditioning)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">predicted_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="c1"># Compute the generator loss</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="c1"># The generator wants the discriminator to classify synthetic data as real (label = 0)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">total_loss_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">),</span> <span class="n">predicted_labels</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="c1"># Compute gradients of the generator loss with respect to generator trainable weights</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">generator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">total_loss_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="c1"># Apply the computed gradients to update generator weights</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="c1"># Return a dictionary containing both losses for tracking</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;loss_d&quot;</span><span class="p">:</span> <span class="n">loss_value</span><span class="p">,</span> <span class="s2">&quot;loss_g&quot;</span><span class="p">:</span> <span class="n">total_loss_g</span><span class="p">}</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_samples_per_class</span><span class="p">):</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        Generates synthetic data samples for each specified class using the trained generator.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        Args:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">            number_samples_per_class (dict):</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">                A dictionary specifying the number of synthetic samples to generate per class.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">                Expected structure:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">                {</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">                    &quot;classes&quot;: {class_label: number_of_samples, ...},</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">                    &quot;number_classes&quot;: total_number_of_classes</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">                }</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        Returns:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">            dict:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">                A dictionary where each key is a class label and the value is an array of generated samples for that class.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="c1"># Initialize an empty dictionary to store generated samples grouped by class</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="n">generated_data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="c1"># Iterate over each class and the corresponding number of samples to generate</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">for</span> <span class="n">label_class</span><span class="p">,</span> <span class="n">number_instances</span> <span class="ow">in</span> <span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="c1"># Create one-hot encoded labels for all generated samples in this class</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>            <span class="c1"># Example: if label_class = 2 and number_instances = 5, this will generate:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="c1"># [[0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1]]</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">label_samples_generated</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_instances</span><span class="p">,</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                <span class="n">num_classes</span><span class="o">=</span><span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;number_classes&quot;</span><span class="p">]</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="c1"># Generate random noise vectors (latent vectors) for each sample</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="c1"># Shape: (number_instances, latent_dimension)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="n">latent_noise</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span><span class="p">,</span>  <span class="c1"># Mean of the latent space distribution</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span><span class="p">,</span>  <span class="c1"># Standard deviation of the latent space distribution</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>                <span class="p">(</span><span class="n">number_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="c1"># Use the generator to produce synthetic samples conditioned on the class labels</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="c1"># Inputs: latent noise vectors and one-hot class labels</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>            <span class="c1"># &#39;verbose=0&#39; suppresses console output from the predict call</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">latent_noise</span><span class="p">,</span> <span class="n">label_samples_generated</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>            <span class="c1"># Round generated sample values to nearest integer (useful if generating binary data, like images with pixel values 0/1)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">generated_samples</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="c1"># Store the generated samples in the dictionary under the corresponding class label</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">generated_data</span><span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">=</span> <span class="n">generated_samples</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="c1"># Return the dictionary containing all generated samples, grouped by class</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">return</span> <span class="n">generated_data</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>    <span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting to save Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span><span class="p">))</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="c1"># Create directory for saving models</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_directory</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_directory</span><span class="p">))</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="c1"># Directory for the current fold</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="s2">&quot;fold_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified fold directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_model</span><span class="p">))</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="c1"># Full paths for the model files</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>            <span class="c1"># Saving discriminator model to JSON and weights</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving discriminator model...&quot;</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Discriminator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">,</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                                                                                  <span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>            <span class="c1"># Saving generator model to JSON and weights</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving generator model...&quot;</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="n">generator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">,</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>                                                                              <span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file already exists. Aborting.&quot;</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while saving the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">load_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>            <span class="c1"># Directory containing saved models</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="c1"># Full paths to the model files</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="c1"># Load discriminator model</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading discriminator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded discriminator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="c1"># Load generator model</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading generator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                <span class="n">generator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded generator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file not found. Please provide an existing and valid model.&quot;</span><span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while loading the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>    <span class="k">def</span> <span class="nf">set_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">set_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">set_latent_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latent_dimension</span><span class="p">):</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">):</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>    <span class="k">def</span> <span class="nf">set_loss_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">):</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">set_loss_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">):</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span></pre></div>


            </section>
                <section id="AdversarialAlgorithm">
                            <input id="AdversarialAlgorithm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AdversarialAlgorithm</span><wbr>(<span class="base">keras.src.models.model.Model</span>):

                <label class="view-source-button" for="AdversarialAlgorithm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm-36"><a href="#AdversarialAlgorithm-36"><span class="linenos"> 36</span></a><span class="k">class</span> <span class="nc">AdversarialAlgorithm</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-37"><a href="#AdversarialAlgorithm-37"><span class="linenos"> 37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-38"><a href="#AdversarialAlgorithm-38"><span class="linenos"> 38</span></a><span class="sd">    Implements an adversarial training algorithm, typically used in Generative Adversarial Networks (GANs).</span>
</span><span id="AdversarialAlgorithm-39"><a href="#AdversarialAlgorithm-39"><span class="linenos"> 39</span></a>
</span><span id="AdversarialAlgorithm-40"><a href="#AdversarialAlgorithm-40"><span class="linenos"> 40</span></a><span class="sd">    This class performs adversarial training by utilizing a generator and a discriminator,</span>
</span><span id="AdversarialAlgorithm-41"><a href="#AdversarialAlgorithm-41"><span class="linenos"> 41</span></a><span class="sd">    optimizing the generator to produce realistic data while training the discriminator to differentiate</span>
</span><span id="AdversarialAlgorithm-42"><a href="#AdversarialAlgorithm-42"><span class="linenos"> 42</span></a><span class="sd">    between real and fake data.</span>
</span><span id="AdversarialAlgorithm-43"><a href="#AdversarialAlgorithm-43"><span class="linenos"> 43</span></a>
</span><span id="AdversarialAlgorithm-44"><a href="#AdversarialAlgorithm-44"><span class="linenos"> 44</span></a><span class="sd">    The concept of Generative Adversarial Networks was introduced by Ian Goodfellow and his collaborators in</span>
</span><span id="AdversarialAlgorithm-45"><a href="#AdversarialAlgorithm-45"><span class="linenos"> 45</span></a><span class="sd">    the following paper:</span>
</span><span id="AdversarialAlgorithm-46"><a href="#AdversarialAlgorithm-46"><span class="linenos"> 46</span></a>
</span><span id="AdversarialAlgorithm-47"><a href="#AdversarialAlgorithm-47"><span class="linenos"> 47</span></a><span class="sd">    Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., . . . Bengio, Y. (2014).</span>
</span><span id="AdversarialAlgorithm-48"><a href="#AdversarialAlgorithm-48"><span class="linenos"> 48</span></a><span class="sd">    Generative Adversarial Nets. In Advances in Neural Information Processing Systems (NeurIPS).</span>
</span><span id="AdversarialAlgorithm-49"><a href="#AdversarialAlgorithm-49"><span class="linenos"> 49</span></a>
</span><span id="AdversarialAlgorithm-50"><a href="#AdversarialAlgorithm-50"><span class="linenos"> 50</span></a><span class="sd">    Attributes:</span>
</span><span id="AdversarialAlgorithm-51"><a href="#AdversarialAlgorithm-51"><span class="linenos"> 51</span></a><span class="sd">        @generator_model (Model):</span>
</span><span id="AdversarialAlgorithm-52"><a href="#AdversarialAlgorithm-52"><span class="linenos"> 52</span></a><span class="sd">            The generator model.</span>
</span><span id="AdversarialAlgorithm-53"><a href="#AdversarialAlgorithm-53"><span class="linenos"> 53</span></a><span class="sd">        @discriminator_model (Model):</span>
</span><span id="AdversarialAlgorithm-54"><a href="#AdversarialAlgorithm-54"><span class="linenos"> 54</span></a><span class="sd">            The discriminator model.</span>
</span><span id="AdversarialAlgorithm-55"><a href="#AdversarialAlgorithm-55"><span class="linenos"> 55</span></a><span class="sd">        @latent_dimension (int):</span>
</span><span id="AdversarialAlgorithm-56"><a href="#AdversarialAlgorithm-56"><span class="linenos"> 56</span></a><span class="sd">            Dimensionality of the latent space.</span>
</span><span id="AdversarialAlgorithm-57"><a href="#AdversarialAlgorithm-57"><span class="linenos"> 57</span></a><span class="sd">        @loss_generator (function):</span>
</span><span id="AdversarialAlgorithm-58"><a href="#AdversarialAlgorithm-58"><span class="linenos"> 58</span></a><span class="sd">            Loss function for the generator.</span>
</span><span id="AdversarialAlgorithm-59"><a href="#AdversarialAlgorithm-59"><span class="linenos"> 59</span></a><span class="sd">        @loss_discriminator (function):</span>
</span><span id="AdversarialAlgorithm-60"><a href="#AdversarialAlgorithm-60"><span class="linenos"> 60</span></a><span class="sd">            Loss function for the discriminator.</span>
</span><span id="AdversarialAlgorithm-61"><a href="#AdversarialAlgorithm-61"><span class="linenos"> 61</span></a><span class="sd">        @file_name_discriminator (str):</span>
</span><span id="AdversarialAlgorithm-62"><a href="#AdversarialAlgorithm-62"><span class="linenos"> 62</span></a><span class="sd">            Filename for saving the discriminator model.</span>
</span><span id="AdversarialAlgorithm-63"><a href="#AdversarialAlgorithm-63"><span class="linenos"> 63</span></a><span class="sd">        @file_name_generator (str):</span>
</span><span id="AdversarialAlgorithm-64"><a href="#AdversarialAlgorithm-64"><span class="linenos"> 64</span></a><span class="sd">            Filename for saving the generator model.</span>
</span><span id="AdversarialAlgorithm-65"><a href="#AdversarialAlgorithm-65"><span class="linenos"> 65</span></a><span class="sd">        @models_saved_path (str):</span>
</span><span id="AdversarialAlgorithm-66"><a href="#AdversarialAlgorithm-66"><span class="linenos"> 66</span></a><span class="sd">            Path where models will be saved.</span>
</span><span id="AdversarialAlgorithm-67"><a href="#AdversarialAlgorithm-67"><span class="linenos"> 67</span></a><span class="sd">        @latent_mean_distribution (float):</span>
</span><span id="AdversarialAlgorithm-68"><a href="#AdversarialAlgorithm-68"><span class="linenos"> 68</span></a><span class="sd">            Mean of the latent noise distribution.</span>
</span><span id="AdversarialAlgorithm-69"><a href="#AdversarialAlgorithm-69"><span class="linenos"> 69</span></a><span class="sd">        @latent_stander_deviation (float):</span>
</span><span id="AdversarialAlgorithm-70"><a href="#AdversarialAlgorithm-70"><span class="linenos"> 70</span></a><span class="sd">            Standard deviation of the latent noise distribution.</span>
</span><span id="AdversarialAlgorithm-71"><a href="#AdversarialAlgorithm-71"><span class="linenos"> 71</span></a><span class="sd">        @smoothing_rate (float):</span>
</span><span id="AdversarialAlgorithm-72"><a href="#AdversarialAlgorithm-72"><span class="linenos"> 72</span></a><span class="sd">            Smoothing rate applied to discriminator labels.</span>
</span><span id="AdversarialAlgorithm-73"><a href="#AdversarialAlgorithm-73"><span class="linenos"> 73</span></a>
</span><span id="AdversarialAlgorithm-74"><a href="#AdversarialAlgorithm-74"><span class="linenos"> 74</span></a><span class="sd">    Example:</span>
</span><span id="AdversarialAlgorithm-75"><a href="#AdversarialAlgorithm-75"><span class="linenos"> 75</span></a><span class="sd">        &gt;&gt;&gt; generator_model = build_generator(latent_dimension=100)</span>
</span><span id="AdversarialAlgorithm-76"><a href="#AdversarialAlgorithm-76"><span class="linenos"> 76</span></a><span class="sd">        ...     discriminator_model = build_discriminator()</span>
</span><span id="AdversarialAlgorithm-77"><a href="#AdversarialAlgorithm-77"><span class="linenos"> 77</span></a><span class="sd">        ...     adversarial_algorithm = AdversarialAlgorithm(</span>
</span><span id="AdversarialAlgorithm-78"><a href="#AdversarialAlgorithm-78"><span class="linenos"> 78</span></a><span class="sd">        ...     generator_model=generator_model,</span>
</span><span id="AdversarialAlgorithm-79"><a href="#AdversarialAlgorithm-79"><span class="linenos"> 79</span></a><span class="sd">        ...     discriminator_model=discriminator_model,</span>
</span><span id="AdversarialAlgorithm-80"><a href="#AdversarialAlgorithm-80"><span class="linenos"> 80</span></a><span class="sd">        ...     latent_dimension=100,</span>
</span><span id="AdversarialAlgorithm-81"><a href="#AdversarialAlgorithm-81"><span class="linenos"> 81</span></a><span class="sd">        ...     loss_generator=tf.keras.losses.BinaryCrossentropy(),</span>
</span><span id="AdversarialAlgorithm-82"><a href="#AdversarialAlgorithm-82"><span class="linenos"> 82</span></a><span class="sd">        ...     loss_discriminator=tf.keras.losses.BinaryCrossentropy(),</span>
</span><span id="AdversarialAlgorithm-83"><a href="#AdversarialAlgorithm-83"><span class="linenos"> 83</span></a><span class="sd">        ...     file_name_discriminator=&quot;discriminator.h5&quot;,</span>
</span><span id="AdversarialAlgorithm-84"><a href="#AdversarialAlgorithm-84"><span class="linenos"> 84</span></a><span class="sd">        ...     file_name_generator=&quot;generator.h5&quot;,</span>
</span><span id="AdversarialAlgorithm-85"><a href="#AdversarialAlgorithm-85"><span class="linenos"> 85</span></a><span class="sd">        ...     models_saved_path=&quot;./models/&quot;,</span>
</span><span id="AdversarialAlgorithm-86"><a href="#AdversarialAlgorithm-86"><span class="linenos"> 86</span></a><span class="sd">        ...     latent_mean_distribution=0.0,</span>
</span><span id="AdversarialAlgorithm-87"><a href="#AdversarialAlgorithm-87"><span class="linenos"> 87</span></a><span class="sd">        ...     latent_stander_deviation=1.0,</span>
</span><span id="AdversarialAlgorithm-88"><a href="#AdversarialAlgorithm-88"><span class="linenos"> 88</span></a><span class="sd">        ...     smoothing_rate=0.1</span>
</span><span id="AdversarialAlgorithm-89"><a href="#AdversarialAlgorithm-89"><span class="linenos"> 89</span></a><span class="sd">        ...     )</span>
</span><span id="AdversarialAlgorithm-90"><a href="#AdversarialAlgorithm-90"><span class="linenos"> 90</span></a><span class="sd">        ...     adversarial_algorithm.compile(</span>
</span><span id="AdversarialAlgorithm-91"><a href="#AdversarialAlgorithm-91"><span class="linenos"> 91</span></a><span class="sd">        ...     optimizer_generator=tf.keras.optimizers.Adam(learning_rate=0.0002),</span>
</span><span id="AdversarialAlgorithm-92"><a href="#AdversarialAlgorithm-92"><span class="linenos"> 92</span></a><span class="sd">        ...     optimizer_discriminator=tf.keras.optimizers.Adam(learning_rate=0.0002)</span>
</span><span id="AdversarialAlgorithm-93"><a href="#AdversarialAlgorithm-93"><span class="linenos"> 93</span></a><span class="sd">        ...     )</span>
</span><span id="AdversarialAlgorithm-94"><a href="#AdversarialAlgorithm-94"><span class="linenos"> 94</span></a><span class="sd">        # Train the model</span>
</span><span id="AdversarialAlgorithm-95"><a href="#AdversarialAlgorithm-95"><span class="linenos"> 95</span></a><span class="sd">        &gt;&gt;&gt; adversarial_algorithm.fit(train_dataset)</span>
</span><span id="AdversarialAlgorithm-96"><a href="#AdversarialAlgorithm-96"><span class="linenos"> 96</span></a>
</span><span id="AdversarialAlgorithm-97"><a href="#AdversarialAlgorithm-97"><span class="linenos"> 97</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-98"><a href="#AdversarialAlgorithm-98"><span class="linenos"> 98</span></a>
</span><span id="AdversarialAlgorithm-99"><a href="#AdversarialAlgorithm-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator_model</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-100"><a href="#AdversarialAlgorithm-100"><span class="linenos">100</span></a>                 <span class="n">discriminator_model</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-101"><a href="#AdversarialAlgorithm-101"><span class="linenos">101</span></a>                 <span class="n">latent_dimension</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-102"><a href="#AdversarialAlgorithm-102"><span class="linenos">102</span></a>                 <span class="n">loss_generator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-103"><a href="#AdversarialAlgorithm-103"><span class="linenos">103</span></a>                 <span class="n">loss_discriminator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-104"><a href="#AdversarialAlgorithm-104"><span class="linenos">104</span></a>                 <span class="n">file_name_discriminator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-105"><a href="#AdversarialAlgorithm-105"><span class="linenos">105</span></a>                 <span class="n">file_name_generator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-106"><a href="#AdversarialAlgorithm-106"><span class="linenos">106</span></a>                 <span class="n">models_saved_path</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-107"><a href="#AdversarialAlgorithm-107"><span class="linenos">107</span></a>                 <span class="n">latent_mean_distribution</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-108"><a href="#AdversarialAlgorithm-108"><span class="linenos">108</span></a>                 <span class="n">latent_stander_deviation</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-109"><a href="#AdversarialAlgorithm-109"><span class="linenos">109</span></a>                 <span class="n">smoothing_rate</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-110"><a href="#AdversarialAlgorithm-110"><span class="linenos">110</span></a>                 <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-111"><a href="#AdversarialAlgorithm-111"><span class="linenos">111</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-112"><a href="#AdversarialAlgorithm-112"><span class="linenos">112</span></a>
</span><span id="AdversarialAlgorithm-113"><a href="#AdversarialAlgorithm-113"><span class="linenos">113</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-114"><a href="#AdversarialAlgorithm-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-115"><a href="#AdversarialAlgorithm-115"><span class="linenos">115</span></a><span class="sd">        Initializes the adversarial algorithm with the specified generator, discriminator, and other configurations.</span>
</span><span id="AdversarialAlgorithm-116"><a href="#AdversarialAlgorithm-116"><span class="linenos">116</span></a>
</span><span id="AdversarialAlgorithm-117"><a href="#AdversarialAlgorithm-117"><span class="linenos">117</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm-118"><a href="#AdversarialAlgorithm-118"><span class="linenos">118</span></a><span class="sd">            @generator_model (Model):</span>
</span><span id="AdversarialAlgorithm-119"><a href="#AdversarialAlgorithm-119"><span class="linenos">119</span></a><span class="sd">                The generator model.</span>
</span><span id="AdversarialAlgorithm-120"><a href="#AdversarialAlgorithm-120"><span class="linenos">120</span></a><span class="sd">            @discriminator_model (Model):</span>
</span><span id="AdversarialAlgorithm-121"><a href="#AdversarialAlgorithm-121"><span class="linenos">121</span></a><span class="sd">                The discriminator model.</span>
</span><span id="AdversarialAlgorithm-122"><a href="#AdversarialAlgorithm-122"><span class="linenos">122</span></a><span class="sd">            @latent_dimension (int):</span>
</span><span id="AdversarialAlgorithm-123"><a href="#AdversarialAlgorithm-123"><span class="linenos">123</span></a><span class="sd">                Latent space dimension.</span>
</span><span id="AdversarialAlgorithm-124"><a href="#AdversarialAlgorithm-124"><span class="linenos">124</span></a><span class="sd">            @loss_generator (function):</span>
</span><span id="AdversarialAlgorithm-125"><a href="#AdversarialAlgorithm-125"><span class="linenos">125</span></a><span class="sd">                Generator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm-126"><a href="#AdversarialAlgorithm-126"><span class="linenos">126</span></a><span class="sd">            @loss_discriminator (function):</span>
</span><span id="AdversarialAlgorithm-127"><a href="#AdversarialAlgorithm-127"><span class="linenos">127</span></a><span class="sd">                Discriminator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm-128"><a href="#AdversarialAlgorithm-128"><span class="linenos">128</span></a><span class="sd">            @file_name_discriminator (str):</span>
</span><span id="AdversarialAlgorithm-129"><a href="#AdversarialAlgorithm-129"><span class="linenos">129</span></a><span class="sd">                Filename for discriminator model.</span>
</span><span id="AdversarialAlgorithm-130"><a href="#AdversarialAlgorithm-130"><span class="linenos">130</span></a><span class="sd">            @file_name_generator (str):</span>
</span><span id="AdversarialAlgorithm-131"><a href="#AdversarialAlgorithm-131"><span class="linenos">131</span></a><span class="sd">                Filename for generator model.</span>
</span><span id="AdversarialAlgorithm-132"><a href="#AdversarialAlgorithm-132"><span class="linenos">132</span></a><span class="sd">            @models_saved_path (str):</span>
</span><span id="AdversarialAlgorithm-133"><a href="#AdversarialAlgorithm-133"><span class="linenos">133</span></a><span class="sd">                Path for saving models.</span>
</span><span id="AdversarialAlgorithm-134"><a href="#AdversarialAlgorithm-134"><span class="linenos">134</span></a><span class="sd">            @latent_mean_distribution (float):</span>
</span><span id="AdversarialAlgorithm-135"><a href="#AdversarialAlgorithm-135"><span class="linenos">135</span></a><span class="sd">                Mean of the latent noise distribution.</span>
</span><span id="AdversarialAlgorithm-136"><a href="#AdversarialAlgorithm-136"><span class="linenos">136</span></a><span class="sd">            @latent_stander_deviation (float):</span>
</span><span id="AdversarialAlgorithm-137"><a href="#AdversarialAlgorithm-137"><span class="linenos">137</span></a><span class="sd">                Standard deviation of the latent noise.</span>
</span><span id="AdversarialAlgorithm-138"><a href="#AdversarialAlgorithm-138"><span class="linenos">138</span></a><span class="sd">            @smoothing_rate (float):</span>
</span><span id="AdversarialAlgorithm-139"><a href="#AdversarialAlgorithm-139"><span class="linenos">139</span></a><span class="sd">                Label smoothing rate.</span>
</span><span id="AdversarialAlgorithm-140"><a href="#AdversarialAlgorithm-140"><span class="linenos">140</span></a><span class="sd">            @*args, **kwargs:</span>
</span><span id="AdversarialAlgorithm-141"><a href="#AdversarialAlgorithm-141"><span class="linenos">141</span></a><span class="sd">                Additional arguments.</span>
</span><span id="AdversarialAlgorithm-142"><a href="#AdversarialAlgorithm-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-143"><a href="#AdversarialAlgorithm-143"><span class="linenos">143</span></a>
</span><span id="AdversarialAlgorithm-144"><a href="#AdversarialAlgorithm-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">latent_dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-145"><a href="#AdversarialAlgorithm-145"><span class="linenos">145</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent dimension must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-146"><a href="#AdversarialAlgorithm-146"><span class="linenos">146</span></a>
</span><span id="AdversarialAlgorithm-147"><a href="#AdversarialAlgorithm-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_discriminator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_discriminator</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-148"><a href="#AdversarialAlgorithm-148"><span class="linenos">148</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Discriminator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-149"><a href="#AdversarialAlgorithm-149"><span class="linenos">149</span></a>
</span><span id="AdversarialAlgorithm-150"><a href="#AdversarialAlgorithm-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_generator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_generator</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-151"><a href="#AdversarialAlgorithm-151"><span class="linenos">151</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Generator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-152"><a href="#AdversarialAlgorithm-152"><span class="linenos">152</span></a>
</span><span id="AdversarialAlgorithm-153"><a href="#AdversarialAlgorithm-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">models_saved_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">models_saved_path</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-154"><a href="#AdversarialAlgorithm-154"><span class="linenos">154</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Models saved path must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-155"><a href="#AdversarialAlgorithm-155"><span class="linenos">155</span></a>
</span><span id="AdversarialAlgorithm-156"><a href="#AdversarialAlgorithm-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_mean_distribution</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="AdversarialAlgorithm-157"><a href="#AdversarialAlgorithm-157"><span class="linenos">157</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent mean distribution must be a number.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-158"><a href="#AdversarialAlgorithm-158"><span class="linenos">158</span></a>
</span><span id="AdversarialAlgorithm-159"><a href="#AdversarialAlgorithm-159"><span class="linenos">159</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_stander_deviation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="AdversarialAlgorithm-160"><a href="#AdversarialAlgorithm-160"><span class="linenos">160</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be a number.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-161"><a href="#AdversarialAlgorithm-161"><span class="linenos">161</span></a>
</span><span id="AdversarialAlgorithm-162"><a href="#AdversarialAlgorithm-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">latent_stander_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-163"><a href="#AdversarialAlgorithm-163"><span class="linenos">163</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-164"><a href="#AdversarialAlgorithm-164"><span class="linenos">164</span></a>
</span><span id="AdversarialAlgorithm-165"><a href="#AdversarialAlgorithm-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">smoothing_rate</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-166"><a href="#AdversarialAlgorithm-166"><span class="linenos">166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Smoothing rate must be between 0 and 1.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-167"><a href="#AdversarialAlgorithm-167"><span class="linenos">167</span></a>
</span><span id="AdversarialAlgorithm-168"><a href="#AdversarialAlgorithm-168"><span class="linenos">168</span></a>
</span><span id="AdversarialAlgorithm-169"><a href="#AdversarialAlgorithm-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator_model</span>
</span><span id="AdversarialAlgorithm-170"><a href="#AdversarialAlgorithm-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator_model</span>
</span><span id="AdversarialAlgorithm-171"><a href="#AdversarialAlgorithm-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span><span id="AdversarialAlgorithm-172"><a href="#AdversarialAlgorithm-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AdversarialAlgorithm-173"><a href="#AdversarialAlgorithm-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AdversarialAlgorithm-174"><a href="#AdversarialAlgorithm-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="AdversarialAlgorithm-175"><a href="#AdversarialAlgorithm-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span><span id="AdversarialAlgorithm-176"><a href="#AdversarialAlgorithm-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_smoothing_rate</span> <span class="o">=</span> <span class="n">smoothing_rate</span>
</span><span id="AdversarialAlgorithm-177"><a href="#AdversarialAlgorithm-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span> <span class="o">=</span> <span class="n">latent_mean_distribution</span>
</span><span id="AdversarialAlgorithm-178"><a href="#AdversarialAlgorithm-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span> <span class="o">=</span> <span class="n">latent_stander_deviation</span>
</span><span id="AdversarialAlgorithm-179"><a href="#AdversarialAlgorithm-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">=</span> <span class="n">file_name_discriminator</span>
</span><span id="AdversarialAlgorithm-180"><a href="#AdversarialAlgorithm-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">=</span> <span class="n">file_name_generator</span>
</span><span id="AdversarialAlgorithm-181"><a href="#AdversarialAlgorithm-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span> <span class="o">=</span> <span class="n">models_saved_path</span>
</span><span id="AdversarialAlgorithm-182"><a href="#AdversarialAlgorithm-182"><span class="linenos">182</span></a>
</span><span id="AdversarialAlgorithm-183"><a href="#AdversarialAlgorithm-183"><span class="linenos">183</span></a>
</span><span id="AdversarialAlgorithm-184"><a href="#AdversarialAlgorithm-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-185"><a href="#AdversarialAlgorithm-185"><span class="linenos">185</span></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-186"><a href="#AdversarialAlgorithm-186"><span class="linenos">186</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-187"><a href="#AdversarialAlgorithm-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-188"><a href="#AdversarialAlgorithm-188"><span class="linenos">188</span></a><span class="sd">        Compiles the adversarial algorithm by setting optimizers and loss functions for both generator and discriminator.</span>
</span><span id="AdversarialAlgorithm-189"><a href="#AdversarialAlgorithm-189"><span class="linenos">189</span></a>
</span><span id="AdversarialAlgorithm-190"><a href="#AdversarialAlgorithm-190"><span class="linenos">190</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm-191"><a href="#AdversarialAlgorithm-191"><span class="linenos">191</span></a><span class="sd">            optimizer_generator (Optimizer): Optimizer for the generator.</span>
</span><span id="AdversarialAlgorithm-192"><a href="#AdversarialAlgorithm-192"><span class="linenos">192</span></a><span class="sd">            optimizer_discriminator (Optimizer): Optimizer for the discriminator.</span>
</span><span id="AdversarialAlgorithm-193"><a href="#AdversarialAlgorithm-193"><span class="linenos">193</span></a><span class="sd">            loss_generator (function): Generator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm-194"><a href="#AdversarialAlgorithm-194"><span class="linenos">194</span></a><span class="sd">            loss_discriminator (function): Discriminator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm-195"><a href="#AdversarialAlgorithm-195"><span class="linenos">195</span></a><span class="sd">            *args, **kwargs: Additional arguments.</span>
</span><span id="AdversarialAlgorithm-196"><a href="#AdversarialAlgorithm-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-197"><a href="#AdversarialAlgorithm-197"><span class="linenos">197</span></a>
</span><span id="AdversarialAlgorithm-198"><a href="#AdversarialAlgorithm-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span><span id="AdversarialAlgorithm-199"><a href="#AdversarialAlgorithm-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span><span id="AdversarialAlgorithm-200"><a href="#AdversarialAlgorithm-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="AdversarialAlgorithm-201"><a href="#AdversarialAlgorithm-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span><span id="AdversarialAlgorithm-202"><a href="#AdversarialAlgorithm-202"><span class="linenos">202</span></a>
</span><span id="AdversarialAlgorithm-203"><a href="#AdversarialAlgorithm-203"><span class="linenos">203</span></a>    <span class="nd">@tensorflow</span><span class="o">.</span><span class="n">function</span>
</span><span id="AdversarialAlgorithm-204"><a href="#AdversarialAlgorithm-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-205"><a href="#AdversarialAlgorithm-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-206"><a href="#AdversarialAlgorithm-206"><span class="linenos">206</span></a><span class="sd">        Performs a single training step for both generator and discriminator.</span>
</span><span id="AdversarialAlgorithm-207"><a href="#AdversarialAlgorithm-207"><span class="linenos">207</span></a><span class="sd">        This function is decorated with @tensorflow.function to optimize graph execution.</span>
</span><span id="AdversarialAlgorithm-208"><a href="#AdversarialAlgorithm-208"><span class="linenos">208</span></a>
</span><span id="AdversarialAlgorithm-209"><a href="#AdversarialAlgorithm-209"><span class="linenos">209</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm-210"><a href="#AdversarialAlgorithm-210"><span class="linenos">210</span></a><span class="sd">            batch (tuple): A tuple containing real features (input data) and their corresponding labels.</span>
</span><span id="AdversarialAlgorithm-211"><a href="#AdversarialAlgorithm-211"><span class="linenos">211</span></a>
</span><span id="AdversarialAlgorithm-212"><a href="#AdversarialAlgorithm-212"><span class="linenos">212</span></a><span class="sd">        Returns:</span>
</span><span id="AdversarialAlgorithm-213"><a href="#AdversarialAlgorithm-213"><span class="linenos">213</span></a><span class="sd">            dict: A dictionary containing the loss values for both generator (loss_g) and discriminator (loss_d).</span>
</span><span id="AdversarialAlgorithm-214"><a href="#AdversarialAlgorithm-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-215"><a href="#AdversarialAlgorithm-215"><span class="linenos">215</span></a>
</span><span id="AdversarialAlgorithm-216"><a href="#AdversarialAlgorithm-216"><span class="linenos">216</span></a>        <span class="c1"># Unpack the batch into real features and real labels</span>
</span><span id="AdversarialAlgorithm-217"><a href="#AdversarialAlgorithm-217"><span class="linenos">217</span></a>        <span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">batch</span>
</span><span id="AdversarialAlgorithm-218"><a href="#AdversarialAlgorithm-218"><span class="linenos">218</span></a>
</span><span id="AdversarialAlgorithm-219"><a href="#AdversarialAlgorithm-219"><span class="linenos">219</span></a>        <span class="c1"># Get the current batch size (number of samples in this batch)</span>
</span><span id="AdversarialAlgorithm-220"><a href="#AdversarialAlgorithm-220"><span class="linenos">220</span></a>        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">real_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AdversarialAlgorithm-221"><a href="#AdversarialAlgorithm-221"><span class="linenos">221</span></a>
</span><span id="AdversarialAlgorithm-222"><a href="#AdversarialAlgorithm-222"><span class="linenos">222</span></a>        <span class="c1"># Expand the label tensor to match the expected shape (add a new axis at the end)</span>
</span><span id="AdversarialAlgorithm-223"><a href="#AdversarialAlgorithm-223"><span class="linenos">223</span></a>        <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">real_samples_label</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-224"><a href="#AdversarialAlgorithm-224"><span class="linenos">224</span></a>
</span><span id="AdversarialAlgorithm-225"><a href="#AdversarialAlgorithm-225"><span class="linenos">225</span></a>        <span class="c1"># Sample random noise vectors (latent space) for the generator input</span>
</span><span id="AdversarialAlgorithm-226"><a href="#AdversarialAlgorithm-226"><span class="linenos">226</span></a>        <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-227"><a href="#AdversarialAlgorithm-227"><span class="linenos">227</span></a>
</span><span id="AdversarialAlgorithm-228"><a href="#AdversarialAlgorithm-228"><span class="linenos">228</span></a>        <span class="c1"># Use the generator to create synthetic (fake) features using noise and real labels (conditioning)</span>
</span><span id="AdversarialAlgorithm-229"><a href="#AdversarialAlgorithm-229"><span class="linenos">229</span></a>        <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-230"><a href="#AdversarialAlgorithm-230"><span class="linenos">230</span></a>
</span><span id="AdversarialAlgorithm-231"><a href="#AdversarialAlgorithm-231"><span class="linenos">231</span></a>        <span class="c1"># Start discriminator training within a gradient tape context to track gradients</span>
</span><span id="AdversarialAlgorithm-232"><a href="#AdversarialAlgorithm-232"><span class="linenos">232</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">discriminator_gradient</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-233"><a href="#AdversarialAlgorithm-233"><span class="linenos">233</span></a>            <span class="c1"># Get discriminator prediction on real samples (real features + real labels)</span>
</span><span id="AdversarialAlgorithm-234"><a href="#AdversarialAlgorithm-234"><span class="linenos">234</span></a>            <span class="n">label_predicted_real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-235"><a href="#AdversarialAlgorithm-235"><span class="linenos">235</span></a>
</span><span id="AdversarialAlgorithm-236"><a href="#AdversarialAlgorithm-236"><span class="linenos">236</span></a>            <span class="c1"># Get discriminator prediction on synthetic (fake) samples (synthetic features + real labels)</span>
</span><span id="AdversarialAlgorithm-237"><a href="#AdversarialAlgorithm-237"><span class="linenos">237</span></a>            <span class="n">label_predicted_synthetic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-238"><a href="#AdversarialAlgorithm-238"><span class="linenos">238</span></a>
</span><span id="AdversarialAlgorithm-239"><a href="#AdversarialAlgorithm-239"><span class="linenos">239</span></a>            <span class="c1"># Concatenate predictions for real and synthetic samples into a single tensor</span>
</span><span id="AdversarialAlgorithm-240"><a href="#AdversarialAlgorithm-240"><span class="linenos">240</span></a>            <span class="n">label_predicted_all_samples</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">label_predicted_real</span><span class="p">,</span> <span class="n">label_predicted_synthetic</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-241"><a href="#AdversarialAlgorithm-241"><span class="linenos">241</span></a>
</span><span id="AdversarialAlgorithm-242"><a href="#AdversarialAlgorithm-242"><span class="linenos">242</span></a>            <span class="c1"># Create the ground-truth labels for the discriminator</span>
</span><span id="AdversarialAlgorithm-243"><a href="#AdversarialAlgorithm-243"><span class="linenos">243</span></a>            <span class="c1"># Real samples should be labeled as 0, synthetic samples as 1</span>
</span><span id="AdversarialAlgorithm-244"><a href="#AdversarialAlgorithm-244"><span class="linenos">244</span></a>            <span class="n">list_all_labels_predicted</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdversarialAlgorithm-245"><a href="#AdversarialAlgorithm-245"><span class="linenos">245</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">),</span>  <span class="c1"># Real labels = 0</span>
</span><span id="AdversarialAlgorithm-246"><a href="#AdversarialAlgorithm-246"><span class="linenos">246</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">)</span>  <span class="c1"># Fake labels = 1</span>
</span><span id="AdversarialAlgorithm-247"><a href="#AdversarialAlgorithm-247"><span class="linenos">247</span></a>            <span class="p">]</span>
</span><span id="AdversarialAlgorithm-248"><a href="#AdversarialAlgorithm-248"><span class="linenos">248</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_all_labels_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-249"><a href="#AdversarialAlgorithm-249"><span class="linenos">249</span></a>
</span><span id="AdversarialAlgorithm-250"><a href="#AdversarialAlgorithm-250"><span class="linenos">250</span></a>            <span class="c1"># Label smoothing for regularization</span>
</span><span id="AdversarialAlgorithm-251"><a href="#AdversarialAlgorithm-251"><span class="linenos">251</span></a>            <span class="c1"># Add random noise to real labels (smooth them slightly downwards)</span>
</span><span id="AdversarialAlgorithm-252"><a href="#AdversarialAlgorithm-252"><span class="linenos">252</span></a>            <span class="n">smooth_tensor_real_data</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-253"><a href="#AdversarialAlgorithm-253"><span class="linenos">253</span></a>
</span><span id="AdversarialAlgorithm-254"><a href="#AdversarialAlgorithm-254"><span class="linenos">254</span></a>            <span class="c1"># Add random noise to fake labels (smooth them slightly upwards)</span>
</span><span id="AdversarialAlgorithm-255"><a href="#AdversarialAlgorithm-255"><span class="linenos">255</span></a>            <span class="n">smooth_tensor_synthetic_data</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm-256"><a href="#AdversarialAlgorithm-256"><span class="linenos">256</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-257"><a href="#AdversarialAlgorithm-257"><span class="linenos">257</span></a>
</span><span id="AdversarialAlgorithm-258"><a href="#AdversarialAlgorithm-258"><span class="linenos">258</span></a>            <span class="c1"># Combine smoothed noise into the label tensor</span>
</span><span id="AdversarialAlgorithm-259"><a href="#AdversarialAlgorithm-259"><span class="linenos">259</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">+=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm-260"><a href="#AdversarialAlgorithm-260"><span class="linenos">260</span></a>                <span class="p">[</span><span class="n">smooth_tensor_real_data</span><span class="p">,</span> <span class="n">smooth_tensor_synthetic_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="AdversarialAlgorithm-261"><a href="#AdversarialAlgorithm-261"><span class="linenos">261</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm-262"><a href="#AdversarialAlgorithm-262"><span class="linenos">262</span></a>
</span><span id="AdversarialAlgorithm-263"><a href="#AdversarialAlgorithm-263"><span class="linenos">263</span></a>            <span class="c1"># Compute the discriminator loss comparing predicted labels to (smoothed) ground-truth labels</span>
</span><span id="AdversarialAlgorithm-264"><a href="#AdversarialAlgorithm-264"><span class="linenos">264</span></a>            <span class="n">loss_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span><span class="p">(</span><span class="n">tensor_labels_predicted</span><span class="p">,</span> <span class="n">label_predicted_all_samples</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-265"><a href="#AdversarialAlgorithm-265"><span class="linenos">265</span></a>
</span><span id="AdversarialAlgorithm-266"><a href="#AdversarialAlgorithm-266"><span class="linenos">266</span></a>        <span class="c1"># Compute gradients of the discriminator loss with respect to discriminator trainable weights</span>
</span><span id="AdversarialAlgorithm-267"><a href="#AdversarialAlgorithm-267"><span class="linenos">267</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">discriminator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-268"><a href="#AdversarialAlgorithm-268"><span class="linenos">268</span></a>
</span><span id="AdversarialAlgorithm-269"><a href="#AdversarialAlgorithm-269"><span class="linenos">269</span></a>        <span class="c1"># Apply the computed gradients to update discriminator weights</span>
</span><span id="AdversarialAlgorithm-270"><a href="#AdversarialAlgorithm-270"><span class="linenos">270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-271"><a href="#AdversarialAlgorithm-271"><span class="linenos">271</span></a>
</span><span id="AdversarialAlgorithm-272"><a href="#AdversarialAlgorithm-272"><span class="linenos">272</span></a>        <span class="c1"># Start generator training within a gradient tape context to track gradients</span>
</span><span id="AdversarialAlgorithm-273"><a href="#AdversarialAlgorithm-273"><span class="linenos">273</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">generator_gradient</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-274"><a href="#AdversarialAlgorithm-274"><span class="linenos">274</span></a>            <span class="c1"># Generate synthetic samples using the generator (in training mode)</span>
</span><span id="AdversarialAlgorithm-275"><a href="#AdversarialAlgorithm-275"><span class="linenos">275</span></a>            <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-276"><a href="#AdversarialAlgorithm-276"><span class="linenos">276</span></a>            <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-277"><a href="#AdversarialAlgorithm-277"><span class="linenos">277</span></a>
</span><span id="AdversarialAlgorithm-278"><a href="#AdversarialAlgorithm-278"><span class="linenos">278</span></a>            <span class="c1"># Get discriminator predictions for the synthetic samples (real labels used for conditioning)</span>
</span><span id="AdversarialAlgorithm-279"><a href="#AdversarialAlgorithm-279"><span class="linenos">279</span></a>            <span class="n">predicted_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-280"><a href="#AdversarialAlgorithm-280"><span class="linenos">280</span></a>
</span><span id="AdversarialAlgorithm-281"><a href="#AdversarialAlgorithm-281"><span class="linenos">281</span></a>            <span class="c1"># Compute the generator loss</span>
</span><span id="AdversarialAlgorithm-282"><a href="#AdversarialAlgorithm-282"><span class="linenos">282</span></a>            <span class="c1"># The generator wants the discriminator to classify synthetic data as real (label = 0)</span>
</span><span id="AdversarialAlgorithm-283"><a href="#AdversarialAlgorithm-283"><span class="linenos">283</span></a>            <span class="n">total_loss_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">),</span> <span class="n">predicted_labels</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-284"><a href="#AdversarialAlgorithm-284"><span class="linenos">284</span></a>
</span><span id="AdversarialAlgorithm-285"><a href="#AdversarialAlgorithm-285"><span class="linenos">285</span></a>        <span class="c1"># Compute gradients of the generator loss with respect to generator trainable weights</span>
</span><span id="AdversarialAlgorithm-286"><a href="#AdversarialAlgorithm-286"><span class="linenos">286</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">generator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">total_loss_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-287"><a href="#AdversarialAlgorithm-287"><span class="linenos">287</span></a>
</span><span id="AdversarialAlgorithm-288"><a href="#AdversarialAlgorithm-288"><span class="linenos">288</span></a>        <span class="c1"># Apply the computed gradients to update generator weights</span>
</span><span id="AdversarialAlgorithm-289"><a href="#AdversarialAlgorithm-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-290"><a href="#AdversarialAlgorithm-290"><span class="linenos">290</span></a>
</span><span id="AdversarialAlgorithm-291"><a href="#AdversarialAlgorithm-291"><span class="linenos">291</span></a>        <span class="c1"># Return a dictionary containing both losses for tracking</span>
</span><span id="AdversarialAlgorithm-292"><a href="#AdversarialAlgorithm-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;loss_d&quot;</span><span class="p">:</span> <span class="n">loss_value</span><span class="p">,</span> <span class="s2">&quot;loss_g&quot;</span><span class="p">:</span> <span class="n">total_loss_g</span><span class="p">}</span>
</span><span id="AdversarialAlgorithm-293"><a href="#AdversarialAlgorithm-293"><span class="linenos">293</span></a>
</span><span id="AdversarialAlgorithm-294"><a href="#AdversarialAlgorithm-294"><span class="linenos">294</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_samples_per_class</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-295"><a href="#AdversarialAlgorithm-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-296"><a href="#AdversarialAlgorithm-296"><span class="linenos">296</span></a><span class="sd">        Generates synthetic data samples for each specified class using the trained generator.</span>
</span><span id="AdversarialAlgorithm-297"><a href="#AdversarialAlgorithm-297"><span class="linenos">297</span></a>
</span><span id="AdversarialAlgorithm-298"><a href="#AdversarialAlgorithm-298"><span class="linenos">298</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm-299"><a href="#AdversarialAlgorithm-299"><span class="linenos">299</span></a><span class="sd">            number_samples_per_class (dict):</span>
</span><span id="AdversarialAlgorithm-300"><a href="#AdversarialAlgorithm-300"><span class="linenos">300</span></a><span class="sd">                A dictionary specifying the number of synthetic samples to generate per class.</span>
</span><span id="AdversarialAlgorithm-301"><a href="#AdversarialAlgorithm-301"><span class="linenos">301</span></a><span class="sd">                Expected structure:</span>
</span><span id="AdversarialAlgorithm-302"><a href="#AdversarialAlgorithm-302"><span class="linenos">302</span></a><span class="sd">                {</span>
</span><span id="AdversarialAlgorithm-303"><a href="#AdversarialAlgorithm-303"><span class="linenos">303</span></a><span class="sd">                    &quot;classes&quot;: {class_label: number_of_samples, ...},</span>
</span><span id="AdversarialAlgorithm-304"><a href="#AdversarialAlgorithm-304"><span class="linenos">304</span></a><span class="sd">                    &quot;number_classes&quot;: total_number_of_classes</span>
</span><span id="AdversarialAlgorithm-305"><a href="#AdversarialAlgorithm-305"><span class="linenos">305</span></a><span class="sd">                }</span>
</span><span id="AdversarialAlgorithm-306"><a href="#AdversarialAlgorithm-306"><span class="linenos">306</span></a>
</span><span id="AdversarialAlgorithm-307"><a href="#AdversarialAlgorithm-307"><span class="linenos">307</span></a><span class="sd">        Returns:</span>
</span><span id="AdversarialAlgorithm-308"><a href="#AdversarialAlgorithm-308"><span class="linenos">308</span></a><span class="sd">            dict:</span>
</span><span id="AdversarialAlgorithm-309"><a href="#AdversarialAlgorithm-309"><span class="linenos">309</span></a><span class="sd">                A dictionary where each key is a class label and the value is an array of generated samples for that class.</span>
</span><span id="AdversarialAlgorithm-310"><a href="#AdversarialAlgorithm-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm-311"><a href="#AdversarialAlgorithm-311"><span class="linenos">311</span></a>
</span><span id="AdversarialAlgorithm-312"><a href="#AdversarialAlgorithm-312"><span class="linenos">312</span></a>        <span class="c1"># Initialize an empty dictionary to store generated samples grouped by class</span>
</span><span id="AdversarialAlgorithm-313"><a href="#AdversarialAlgorithm-313"><span class="linenos">313</span></a>        <span class="n">generated_data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AdversarialAlgorithm-314"><a href="#AdversarialAlgorithm-314"><span class="linenos">314</span></a>
</span><span id="AdversarialAlgorithm-315"><a href="#AdversarialAlgorithm-315"><span class="linenos">315</span></a>        <span class="c1"># Iterate over each class and the corresponding number of samples to generate</span>
</span><span id="AdversarialAlgorithm-316"><a href="#AdversarialAlgorithm-316"><span class="linenos">316</span></a>        <span class="k">for</span> <span class="n">label_class</span><span class="p">,</span> <span class="n">number_instances</span> <span class="ow">in</span> <span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdversarialAlgorithm-317"><a href="#AdversarialAlgorithm-317"><span class="linenos">317</span></a>            <span class="c1"># Create one-hot encoded labels for all generated samples in this class</span>
</span><span id="AdversarialAlgorithm-318"><a href="#AdversarialAlgorithm-318"><span class="linenos">318</span></a>            <span class="c1"># Example: if label_class = 2 and number_instances = 5, this will generate:</span>
</span><span id="AdversarialAlgorithm-319"><a href="#AdversarialAlgorithm-319"><span class="linenos">319</span></a>            <span class="c1"># [[0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1]]</span>
</span><span id="AdversarialAlgorithm-320"><a href="#AdversarialAlgorithm-320"><span class="linenos">320</span></a>            <span class="n">label_samples_generated</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm-321"><a href="#AdversarialAlgorithm-321"><span class="linenos">321</span></a>                <span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_instances</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-322"><a href="#AdversarialAlgorithm-322"><span class="linenos">322</span></a>                <span class="n">num_classes</span><span class="o">=</span><span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;number_classes&quot;</span><span class="p">]</span>
</span><span id="AdversarialAlgorithm-323"><a href="#AdversarialAlgorithm-323"><span class="linenos">323</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm-324"><a href="#AdversarialAlgorithm-324"><span class="linenos">324</span></a>
</span><span id="AdversarialAlgorithm-325"><a href="#AdversarialAlgorithm-325"><span class="linenos">325</span></a>            <span class="c1"># Generate random noise vectors (latent vectors) for each sample</span>
</span><span id="AdversarialAlgorithm-326"><a href="#AdversarialAlgorithm-326"><span class="linenos">326</span></a>            <span class="c1"># Shape: (number_instances, latent_dimension)</span>
</span><span id="AdversarialAlgorithm-327"><a href="#AdversarialAlgorithm-327"><span class="linenos">327</span></a>            <span class="n">latent_noise</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm-328"><a href="#AdversarialAlgorithm-328"><span class="linenos">328</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span><span class="p">,</span>  <span class="c1"># Mean of the latent space distribution</span>
</span><span id="AdversarialAlgorithm-329"><a href="#AdversarialAlgorithm-329"><span class="linenos">329</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span><span class="p">,</span>  <span class="c1"># Standard deviation of the latent space distribution</span>
</span><span id="AdversarialAlgorithm-330"><a href="#AdversarialAlgorithm-330"><span class="linenos">330</span></a>                <span class="p">(</span><span class="n">number_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-331"><a href="#AdversarialAlgorithm-331"><span class="linenos">331</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm-332"><a href="#AdversarialAlgorithm-332"><span class="linenos">332</span></a>
</span><span id="AdversarialAlgorithm-333"><a href="#AdversarialAlgorithm-333"><span class="linenos">333</span></a>            <span class="c1"># Use the generator to produce synthetic samples conditioned on the class labels</span>
</span><span id="AdversarialAlgorithm-334"><a href="#AdversarialAlgorithm-334"><span class="linenos">334</span></a>            <span class="c1"># Inputs: latent noise vectors and one-hot class labels</span>
</span><span id="AdversarialAlgorithm-335"><a href="#AdversarialAlgorithm-335"><span class="linenos">335</span></a>            <span class="c1"># &#39;verbose=0&#39; suppresses console output from the predict call</span>
</span><span id="AdversarialAlgorithm-336"><a href="#AdversarialAlgorithm-336"><span class="linenos">336</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">latent_noise</span><span class="p">,</span> <span class="n">label_samples_generated</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-337"><a href="#AdversarialAlgorithm-337"><span class="linenos">337</span></a>
</span><span id="AdversarialAlgorithm-338"><a href="#AdversarialAlgorithm-338"><span class="linenos">338</span></a>            <span class="c1"># Round generated sample values to nearest integer (useful if generating binary data, like images with pixel values 0/1)</span>
</span><span id="AdversarialAlgorithm-339"><a href="#AdversarialAlgorithm-339"><span class="linenos">339</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">generated_samples</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-340"><a href="#AdversarialAlgorithm-340"><span class="linenos">340</span></a>
</span><span id="AdversarialAlgorithm-341"><a href="#AdversarialAlgorithm-341"><span class="linenos">341</span></a>            <span class="c1"># Store the generated samples in the dictionary under the corresponding class label</span>
</span><span id="AdversarialAlgorithm-342"><a href="#AdversarialAlgorithm-342"><span class="linenos">342</span></a>            <span class="n">generated_data</span><span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">=</span> <span class="n">generated_samples</span>
</span><span id="AdversarialAlgorithm-343"><a href="#AdversarialAlgorithm-343"><span class="linenos">343</span></a>
</span><span id="AdversarialAlgorithm-344"><a href="#AdversarialAlgorithm-344"><span class="linenos">344</span></a>        <span class="c1"># Return the dictionary containing all generated samples, grouped by class</span>
</span><span id="AdversarialAlgorithm-345"><a href="#AdversarialAlgorithm-345"><span class="linenos">345</span></a>        <span class="k">return</span> <span class="n">generated_data</span>
</span><span id="AdversarialAlgorithm-346"><a href="#AdversarialAlgorithm-346"><span class="linenos">346</span></a>
</span><span id="AdversarialAlgorithm-347"><a href="#AdversarialAlgorithm-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-348"><a href="#AdversarialAlgorithm-348"><span class="linenos">348</span></a>
</span><span id="AdversarialAlgorithm-349"><a href="#AdversarialAlgorithm-349"><span class="linenos">349</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-350"><a href="#AdversarialAlgorithm-350"><span class="linenos">350</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting to save Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-351"><a href="#AdversarialAlgorithm-351"><span class="linenos">351</span></a>
</span><span id="AdversarialAlgorithm-352"><a href="#AdversarialAlgorithm-352"><span class="linenos">352</span></a>            <span class="c1"># Create directory for saving models</span>
</span><span id="AdversarialAlgorithm-353"><a href="#AdversarialAlgorithm-353"><span class="linenos">353</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-354"><a href="#AdversarialAlgorithm-354"><span class="linenos">354</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_directory</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-355"><a href="#AdversarialAlgorithm-355"><span class="linenos">355</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_directory</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-356"><a href="#AdversarialAlgorithm-356"><span class="linenos">356</span></a>
</span><span id="AdversarialAlgorithm-357"><a href="#AdversarialAlgorithm-357"><span class="linenos">357</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="AdversarialAlgorithm-358"><a href="#AdversarialAlgorithm-358"><span class="linenos">358</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-359"><a href="#AdversarialAlgorithm-359"><span class="linenos">359</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-360"><a href="#AdversarialAlgorithm-360"><span class="linenos">360</span></a>
</span><span id="AdversarialAlgorithm-361"><a href="#AdversarialAlgorithm-361"><span class="linenos">361</span></a>            <span class="c1"># Directory for the current fold</span>
</span><span id="AdversarialAlgorithm-362"><a href="#AdversarialAlgorithm-362"><span class="linenos">362</span></a>            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="s2">&quot;fold_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-363"><a href="#AdversarialAlgorithm-363"><span class="linenos">363</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-364"><a href="#AdversarialAlgorithm-364"><span class="linenos">364</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified fold directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_model</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-365"><a href="#AdversarialAlgorithm-365"><span class="linenos">365</span></a>
</span><span id="AdversarialAlgorithm-366"><a href="#AdversarialAlgorithm-366"><span class="linenos">366</span></a>            <span class="c1"># Full paths for the model files</span>
</span><span id="AdversarialAlgorithm-367"><a href="#AdversarialAlgorithm-367"><span class="linenos">367</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-368"><a href="#AdversarialAlgorithm-368"><span class="linenos">368</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-369"><a href="#AdversarialAlgorithm-369"><span class="linenos">369</span></a>
</span><span id="AdversarialAlgorithm-370"><a href="#AdversarialAlgorithm-370"><span class="linenos">370</span></a>            <span class="c1"># Saving discriminator model to JSON and weights</span>
</span><span id="AdversarialAlgorithm-371"><a href="#AdversarialAlgorithm-371"><span class="linenos">371</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving discriminator model...&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-372"><a href="#AdversarialAlgorithm-372"><span class="linenos">372</span></a>            <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm-373"><a href="#AdversarialAlgorithm-373"><span class="linenos">373</span></a>
</span><span id="AdversarialAlgorithm-374"><a href="#AdversarialAlgorithm-374"><span class="linenos">374</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-375"><a href="#AdversarialAlgorithm-375"><span class="linenos">375</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-376"><a href="#AdversarialAlgorithm-376"><span class="linenos">376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-377"><a href="#AdversarialAlgorithm-377"><span class="linenos">377</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Discriminator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-378"><a href="#AdversarialAlgorithm-378"><span class="linenos">378</span></a>                                                                                  <span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-379"><a href="#AdversarialAlgorithm-379"><span class="linenos">379</span></a>
</span><span id="AdversarialAlgorithm-380"><a href="#AdversarialAlgorithm-380"><span class="linenos">380</span></a>            <span class="c1"># Saving generator model to JSON and weights</span>
</span><span id="AdversarialAlgorithm-381"><a href="#AdversarialAlgorithm-381"><span class="linenos">381</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving generator model...&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-382"><a href="#AdversarialAlgorithm-382"><span class="linenos">382</span></a>            <span class="n">generator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm-383"><a href="#AdversarialAlgorithm-383"><span class="linenos">383</span></a>
</span><span id="AdversarialAlgorithm-384"><a href="#AdversarialAlgorithm-384"><span class="linenos">384</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-385"><a href="#AdversarialAlgorithm-385"><span class="linenos">385</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-386"><a href="#AdversarialAlgorithm-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-387"><a href="#AdversarialAlgorithm-387"><span class="linenos">387</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm-388"><a href="#AdversarialAlgorithm-388"><span class="linenos">388</span></a>                                                                              <span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-389"><a href="#AdversarialAlgorithm-389"><span class="linenos">389</span></a>
</span><span id="AdversarialAlgorithm-390"><a href="#AdversarialAlgorithm-390"><span class="linenos">390</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-391"><a href="#AdversarialAlgorithm-391"><span class="linenos">391</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file already exists. Aborting.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-392"><a href="#AdversarialAlgorithm-392"><span class="linenos">392</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-393"><a href="#AdversarialAlgorithm-393"><span class="linenos">393</span></a>
</span><span id="AdversarialAlgorithm-394"><a href="#AdversarialAlgorithm-394"><span class="linenos">394</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-395"><a href="#AdversarialAlgorithm-395"><span class="linenos">395</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while saving the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-396"><a href="#AdversarialAlgorithm-396"><span class="linenos">396</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-397"><a href="#AdversarialAlgorithm-397"><span class="linenos">397</span></a>
</span><span id="AdversarialAlgorithm-398"><a href="#AdversarialAlgorithm-398"><span class="linenos">398</span></a>    <span class="k">def</span> <span class="nf">load_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-399"><a href="#AdversarialAlgorithm-399"><span class="linenos">399</span></a>
</span><span id="AdversarialAlgorithm-400"><a href="#AdversarialAlgorithm-400"><span class="linenos">400</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-401"><a href="#AdversarialAlgorithm-401"><span class="linenos">401</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-402"><a href="#AdversarialAlgorithm-402"><span class="linenos">402</span></a>
</span><span id="AdversarialAlgorithm-403"><a href="#AdversarialAlgorithm-403"><span class="linenos">403</span></a>            <span class="c1"># Directory containing saved models</span>
</span><span id="AdversarialAlgorithm-404"><a href="#AdversarialAlgorithm-404"><span class="linenos">404</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-405"><a href="#AdversarialAlgorithm-405"><span class="linenos">405</span></a>
</span><span id="AdversarialAlgorithm-406"><a href="#AdversarialAlgorithm-406"><span class="linenos">406</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="AdversarialAlgorithm-407"><a href="#AdversarialAlgorithm-407"><span class="linenos">407</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-408"><a href="#AdversarialAlgorithm-408"><span class="linenos">408</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-409"><a href="#AdversarialAlgorithm-409"><span class="linenos">409</span></a>
</span><span id="AdversarialAlgorithm-410"><a href="#AdversarialAlgorithm-410"><span class="linenos">410</span></a>            <span class="c1"># Full paths to the model files</span>
</span><span id="AdversarialAlgorithm-411"><a href="#AdversarialAlgorithm-411"><span class="linenos">411</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-412"><a href="#AdversarialAlgorithm-412"><span class="linenos">412</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-413"><a href="#AdversarialAlgorithm-413"><span class="linenos">413</span></a>
</span><span id="AdversarialAlgorithm-414"><a href="#AdversarialAlgorithm-414"><span class="linenos">414</span></a>            <span class="c1"># Load discriminator model</span>
</span><span id="AdversarialAlgorithm-415"><a href="#AdversarialAlgorithm-415"><span class="linenos">415</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading discriminator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-416"><a href="#AdversarialAlgorithm-416"><span class="linenos">416</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-417"><a href="#AdversarialAlgorithm-417"><span class="linenos">417</span></a>                <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm-418"><a href="#AdversarialAlgorithm-418"><span class="linenos">418</span></a>
</span><span id="AdversarialAlgorithm-419"><a href="#AdversarialAlgorithm-419"><span class="linenos">419</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-420"><a href="#AdversarialAlgorithm-420"><span class="linenos">420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-421"><a href="#AdversarialAlgorithm-421"><span class="linenos">421</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded discriminator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-422"><a href="#AdversarialAlgorithm-422"><span class="linenos">422</span></a>
</span><span id="AdversarialAlgorithm-423"><a href="#AdversarialAlgorithm-423"><span class="linenos">423</span></a>            <span class="c1"># Load generator model</span>
</span><span id="AdversarialAlgorithm-424"><a href="#AdversarialAlgorithm-424"><span class="linenos">424</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading generator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-425"><a href="#AdversarialAlgorithm-425"><span class="linenos">425</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-426"><a href="#AdversarialAlgorithm-426"><span class="linenos">426</span></a>                <span class="n">generator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm-427"><a href="#AdversarialAlgorithm-427"><span class="linenos">427</span></a>
</span><span id="AdversarialAlgorithm-428"><a href="#AdversarialAlgorithm-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-429"><a href="#AdversarialAlgorithm-429"><span class="linenos">429</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-430"><a href="#AdversarialAlgorithm-430"><span class="linenos">430</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded generator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-431"><a href="#AdversarialAlgorithm-431"><span class="linenos">431</span></a>
</span><span id="AdversarialAlgorithm-432"><a href="#AdversarialAlgorithm-432"><span class="linenos">432</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-433"><a href="#AdversarialAlgorithm-433"><span class="linenos">433</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file not found. Please provide an existing and valid model.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-434"><a href="#AdversarialAlgorithm-434"><span class="linenos">434</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-435"><a href="#AdversarialAlgorithm-435"><span class="linenos">435</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm-436"><a href="#AdversarialAlgorithm-436"><span class="linenos">436</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while loading the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm-437"><a href="#AdversarialAlgorithm-437"><span class="linenos">437</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm-438"><a href="#AdversarialAlgorithm-438"><span class="linenos">438</span></a>
</span><span id="AdversarialAlgorithm-439"><a href="#AdversarialAlgorithm-439"><span class="linenos">439</span></a>    <span class="k">def</span> <span class="nf">set_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-440"><a href="#AdversarialAlgorithm-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator</span>
</span><span id="AdversarialAlgorithm-441"><a href="#AdversarialAlgorithm-441"><span class="linenos">441</span></a>
</span><span id="AdversarialAlgorithm-442"><a href="#AdversarialAlgorithm-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">set_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-443"><a href="#AdversarialAlgorithm-443"><span class="linenos">443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator</span>
</span><span id="AdversarialAlgorithm-444"><a href="#AdversarialAlgorithm-444"><span class="linenos">444</span></a>
</span><span id="AdversarialAlgorithm-445"><a href="#AdversarialAlgorithm-445"><span class="linenos">445</span></a>    <span class="k">def</span> <span class="nf">set_latent_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latent_dimension</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-446"><a href="#AdversarialAlgorithm-446"><span class="linenos">446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span><span id="AdversarialAlgorithm-447"><a href="#AdversarialAlgorithm-447"><span class="linenos">447</span></a>
</span><span id="AdversarialAlgorithm-448"><a href="#AdversarialAlgorithm-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-449"><a href="#AdversarialAlgorithm-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span><span id="AdversarialAlgorithm-450"><a href="#AdversarialAlgorithm-450"><span class="linenos">450</span></a>
</span><span id="AdversarialAlgorithm-451"><a href="#AdversarialAlgorithm-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-452"><a href="#AdversarialAlgorithm-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span><span id="AdversarialAlgorithm-453"><a href="#AdversarialAlgorithm-453"><span class="linenos">453</span></a>
</span><span id="AdversarialAlgorithm-454"><a href="#AdversarialAlgorithm-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">set_loss_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-455"><a href="#AdversarialAlgorithm-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="AdversarialAlgorithm-456"><a href="#AdversarialAlgorithm-456"><span class="linenos">456</span></a>
</span><span id="AdversarialAlgorithm-457"><a href="#AdversarialAlgorithm-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">set_loss_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm-458"><a href="#AdversarialAlgorithm-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span></pre></div>


            <div class="docstring"><p>Implements an adversarial training algorithm, typically used in Generative Adversarial Networks (GANs).</p>

<p>This class performs adversarial training by utilizing a generator and a discriminator,
optimizing the generator to produce realistic data while training the discriminator to differentiate
between real and fake data.</p>

<p>The concept of Generative Adversarial Networks was introduced by Ian Goodfellow and his collaborators in
the following paper:</p>

<p>Goodfellow, I., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., . . . Bengio, Y. (2014).
Generative Adversarial Nets. In Advances in Neural Information Processing Systems (NeurIPS).</p>

<p>Attributes:
    @generator_model (Model):
        The generator model.
    @discriminator_model (Model):
        The discriminator model.
    @latent_dimension (int):
        Dimensionality of the latent space.
    @loss_generator (function):
        Loss function for the generator.
    @loss_discriminator (function):
        Loss function for the discriminator.
    @file_name_discriminator (str):
        Filename for saving the discriminator model.
    @file_name_generator (str):
        Filename for saving the generator model.
    @models_saved_path (str):
        Path where models will be saved.
    @latent_mean_distribution (float):
        Mean of the latent noise distribution.
    @latent_stander_deviation (float):
        Standard deviation of the latent noise distribution.
    @smoothing_rate (float):
        Smoothing rate applied to discriminator labels.</p>

<p>Example:</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>generator_model = build_generator(latent_dimension=100)
          ...     discriminator_model = build_discriminator()
          ...     adversarial_algorithm = AdversarialAlgorithm(
          ...     generator_model=generator_model,
          ...     discriminator_model=discriminator_model,
          ...     latent_dimension=100,
          ...     loss_generator=tf.keras.losses.BinaryCrossentropy(),
          ...     loss_discriminator=tf.keras.losses.BinaryCrossentropy(),
          ...     file_name_discriminator="discriminator.h5",
          ...     file_name_generator="generator.h5",
          ...     models_saved_path="./models/",
          ...     latent_mean_distribution=0.0,
          ...     latent_stander_deviation=1.0,
          ...     smoothing_rate=0.1
          ...     )
          ...     adversarial_algorithm.compile(
          ...     optimizer_generator=tf.keras.optimizers.Adam(learning_rate=0.0002),
          ...     optimizer_discriminator=tf.keras.optimizers.Adam(learning_rate=0.0002)
          ...     )
          # Train the model
      adversarial_algorithm.fit(train_dataset)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            <div id="AdversarialAlgorithm.__init__" class="classattr">
                                        <input id="AdversarialAlgorithm.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AdversarialAlgorithm</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">generator_model</span>,</span><span class="param">	<span class="n">discriminator_model</span>,</span><span class="param">	<span class="n">latent_dimension</span>,</span><span class="param">	<span class="n">loss_generator</span>,</span><span class="param">	<span class="n">loss_discriminator</span>,</span><span class="param">	<span class="n">file_name_discriminator</span>,</span><span class="param">	<span class="n">file_name_generator</span>,</span><span class="param">	<span class="n">models_saved_path</span>,</span><span class="param">	<span class="n">latent_mean_distribution</span>,</span><span class="param">	<span class="n">latent_stander_deviation</span>,</span><span class="param">	<span class="n">smoothing_rate</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="AdversarialAlgorithm.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.__init__-99"><a href="#AdversarialAlgorithm.__init__-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator_model</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-100"><a href="#AdversarialAlgorithm.__init__-100"><span class="linenos">100</span></a>                 <span class="n">discriminator_model</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-101"><a href="#AdversarialAlgorithm.__init__-101"><span class="linenos">101</span></a>                 <span class="n">latent_dimension</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-102"><a href="#AdversarialAlgorithm.__init__-102"><span class="linenos">102</span></a>                 <span class="n">loss_generator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-103"><a href="#AdversarialAlgorithm.__init__-103"><span class="linenos">103</span></a>                 <span class="n">loss_discriminator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-104"><a href="#AdversarialAlgorithm.__init__-104"><span class="linenos">104</span></a>                 <span class="n">file_name_discriminator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-105"><a href="#AdversarialAlgorithm.__init__-105"><span class="linenos">105</span></a>                 <span class="n">file_name_generator</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-106"><a href="#AdversarialAlgorithm.__init__-106"><span class="linenos">106</span></a>                 <span class="n">models_saved_path</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-107"><a href="#AdversarialAlgorithm.__init__-107"><span class="linenos">107</span></a>                 <span class="n">latent_mean_distribution</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-108"><a href="#AdversarialAlgorithm.__init__-108"><span class="linenos">108</span></a>                 <span class="n">latent_stander_deviation</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-109"><a href="#AdversarialAlgorithm.__init__-109"><span class="linenos">109</span></a>                 <span class="n">smoothing_rate</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-110"><a href="#AdversarialAlgorithm.__init__-110"><span class="linenos">110</span></a>                 <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.__init__-111"><a href="#AdversarialAlgorithm.__init__-111"><span class="linenos">111</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.__init__-112"><a href="#AdversarialAlgorithm.__init__-112"><span class="linenos">112</span></a>
</span><span id="AdversarialAlgorithm.__init__-113"><a href="#AdversarialAlgorithm.__init__-113"><span class="linenos">113</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-114"><a href="#AdversarialAlgorithm.__init__-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.__init__-115"><a href="#AdversarialAlgorithm.__init__-115"><span class="linenos">115</span></a><span class="sd">        Initializes the adversarial algorithm with the specified generator, discriminator, and other configurations.</span>
</span><span id="AdversarialAlgorithm.__init__-116"><a href="#AdversarialAlgorithm.__init__-116"><span class="linenos">116</span></a>
</span><span id="AdversarialAlgorithm.__init__-117"><a href="#AdversarialAlgorithm.__init__-117"><span class="linenos">117</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm.__init__-118"><a href="#AdversarialAlgorithm.__init__-118"><span class="linenos">118</span></a><span class="sd">            @generator_model (Model):</span>
</span><span id="AdversarialAlgorithm.__init__-119"><a href="#AdversarialAlgorithm.__init__-119"><span class="linenos">119</span></a><span class="sd">                The generator model.</span>
</span><span id="AdversarialAlgorithm.__init__-120"><a href="#AdversarialAlgorithm.__init__-120"><span class="linenos">120</span></a><span class="sd">            @discriminator_model (Model):</span>
</span><span id="AdversarialAlgorithm.__init__-121"><a href="#AdversarialAlgorithm.__init__-121"><span class="linenos">121</span></a><span class="sd">                The discriminator model.</span>
</span><span id="AdversarialAlgorithm.__init__-122"><a href="#AdversarialAlgorithm.__init__-122"><span class="linenos">122</span></a><span class="sd">            @latent_dimension (int):</span>
</span><span id="AdversarialAlgorithm.__init__-123"><a href="#AdversarialAlgorithm.__init__-123"><span class="linenos">123</span></a><span class="sd">                Latent space dimension.</span>
</span><span id="AdversarialAlgorithm.__init__-124"><a href="#AdversarialAlgorithm.__init__-124"><span class="linenos">124</span></a><span class="sd">            @loss_generator (function):</span>
</span><span id="AdversarialAlgorithm.__init__-125"><a href="#AdversarialAlgorithm.__init__-125"><span class="linenos">125</span></a><span class="sd">                Generator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm.__init__-126"><a href="#AdversarialAlgorithm.__init__-126"><span class="linenos">126</span></a><span class="sd">            @loss_discriminator (function):</span>
</span><span id="AdversarialAlgorithm.__init__-127"><a href="#AdversarialAlgorithm.__init__-127"><span class="linenos">127</span></a><span class="sd">                Discriminator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm.__init__-128"><a href="#AdversarialAlgorithm.__init__-128"><span class="linenos">128</span></a><span class="sd">            @file_name_discriminator (str):</span>
</span><span id="AdversarialAlgorithm.__init__-129"><a href="#AdversarialAlgorithm.__init__-129"><span class="linenos">129</span></a><span class="sd">                Filename for discriminator model.</span>
</span><span id="AdversarialAlgorithm.__init__-130"><a href="#AdversarialAlgorithm.__init__-130"><span class="linenos">130</span></a><span class="sd">            @file_name_generator (str):</span>
</span><span id="AdversarialAlgorithm.__init__-131"><a href="#AdversarialAlgorithm.__init__-131"><span class="linenos">131</span></a><span class="sd">                Filename for generator model.</span>
</span><span id="AdversarialAlgorithm.__init__-132"><a href="#AdversarialAlgorithm.__init__-132"><span class="linenos">132</span></a><span class="sd">            @models_saved_path (str):</span>
</span><span id="AdversarialAlgorithm.__init__-133"><a href="#AdversarialAlgorithm.__init__-133"><span class="linenos">133</span></a><span class="sd">                Path for saving models.</span>
</span><span id="AdversarialAlgorithm.__init__-134"><a href="#AdversarialAlgorithm.__init__-134"><span class="linenos">134</span></a><span class="sd">            @latent_mean_distribution (float):</span>
</span><span id="AdversarialAlgorithm.__init__-135"><a href="#AdversarialAlgorithm.__init__-135"><span class="linenos">135</span></a><span class="sd">                Mean of the latent noise distribution.</span>
</span><span id="AdversarialAlgorithm.__init__-136"><a href="#AdversarialAlgorithm.__init__-136"><span class="linenos">136</span></a><span class="sd">            @latent_stander_deviation (float):</span>
</span><span id="AdversarialAlgorithm.__init__-137"><a href="#AdversarialAlgorithm.__init__-137"><span class="linenos">137</span></a><span class="sd">                Standard deviation of the latent noise.</span>
</span><span id="AdversarialAlgorithm.__init__-138"><a href="#AdversarialAlgorithm.__init__-138"><span class="linenos">138</span></a><span class="sd">            @smoothing_rate (float):</span>
</span><span id="AdversarialAlgorithm.__init__-139"><a href="#AdversarialAlgorithm.__init__-139"><span class="linenos">139</span></a><span class="sd">                Label smoothing rate.</span>
</span><span id="AdversarialAlgorithm.__init__-140"><a href="#AdversarialAlgorithm.__init__-140"><span class="linenos">140</span></a><span class="sd">            @*args, **kwargs:</span>
</span><span id="AdversarialAlgorithm.__init__-141"><a href="#AdversarialAlgorithm.__init__-141"><span class="linenos">141</span></a><span class="sd">                Additional arguments.</span>
</span><span id="AdversarialAlgorithm.__init__-142"><a href="#AdversarialAlgorithm.__init__-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.__init__-143"><a href="#AdversarialAlgorithm.__init__-143"><span class="linenos">143</span></a>
</span><span id="AdversarialAlgorithm.__init__-144"><a href="#AdversarialAlgorithm.__init__-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">latent_dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.__init__-145"><a href="#AdversarialAlgorithm.__init__-145"><span class="linenos">145</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent dimension must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-146"><a href="#AdversarialAlgorithm.__init__-146"><span class="linenos">146</span></a>
</span><span id="AdversarialAlgorithm.__init__-147"><a href="#AdversarialAlgorithm.__init__-147"><span class="linenos">147</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_discriminator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_discriminator</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.__init__-148"><a href="#AdversarialAlgorithm.__init__-148"><span class="linenos">148</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Discriminator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-149"><a href="#AdversarialAlgorithm.__init__-149"><span class="linenos">149</span></a>
</span><span id="AdversarialAlgorithm.__init__-150"><a href="#AdversarialAlgorithm.__init__-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_name_generator</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">file_name_generator</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.__init__-151"><a href="#AdversarialAlgorithm.__init__-151"><span class="linenos">151</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Generator file name must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-152"><a href="#AdversarialAlgorithm.__init__-152"><span class="linenos">152</span></a>
</span><span id="AdversarialAlgorithm.__init__-153"><a href="#AdversarialAlgorithm.__init__-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">models_saved_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">models_saved_path</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.__init__-154"><a href="#AdversarialAlgorithm.__init__-154"><span class="linenos">154</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Models saved path must be a non-empty string.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-155"><a href="#AdversarialAlgorithm.__init__-155"><span class="linenos">155</span></a>
</span><span id="AdversarialAlgorithm.__init__-156"><a href="#AdversarialAlgorithm.__init__-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_mean_distribution</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="AdversarialAlgorithm.__init__-157"><a href="#AdversarialAlgorithm.__init__-157"><span class="linenos">157</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent mean distribution must be a number.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-158"><a href="#AdversarialAlgorithm.__init__-158"><span class="linenos">158</span></a>
</span><span id="AdversarialAlgorithm.__init__-159"><a href="#AdversarialAlgorithm.__init__-159"><span class="linenos">159</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latent_stander_deviation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
</span><span id="AdversarialAlgorithm.__init__-160"><a href="#AdversarialAlgorithm.__init__-160"><span class="linenos">160</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be a number.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-161"><a href="#AdversarialAlgorithm.__init__-161"><span class="linenos">161</span></a>
</span><span id="AdversarialAlgorithm.__init__-162"><a href="#AdversarialAlgorithm.__init__-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">latent_stander_deviation</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.__init__-163"><a href="#AdversarialAlgorithm.__init__-163"><span class="linenos">163</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latent standard deviation must be greater than 0.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-164"><a href="#AdversarialAlgorithm.__init__-164"><span class="linenos">164</span></a>
</span><span id="AdversarialAlgorithm.__init__-165"><a href="#AdversarialAlgorithm.__init__-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mf">0.0</span> <span class="o">&lt;=</span> <span class="n">smoothing_rate</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.__init__-166"><a href="#AdversarialAlgorithm.__init__-166"><span class="linenos">166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Smoothing rate must be between 0 and 1.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.__init__-167"><a href="#AdversarialAlgorithm.__init__-167"><span class="linenos">167</span></a>
</span><span id="AdversarialAlgorithm.__init__-168"><a href="#AdversarialAlgorithm.__init__-168"><span class="linenos">168</span></a>
</span><span id="AdversarialAlgorithm.__init__-169"><a href="#AdversarialAlgorithm.__init__-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator_model</span>
</span><span id="AdversarialAlgorithm.__init__-170"><a href="#AdversarialAlgorithm.__init__-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator_model</span>
</span><span id="AdversarialAlgorithm.__init__-171"><a href="#AdversarialAlgorithm.__init__-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span><span id="AdversarialAlgorithm.__init__-172"><a href="#AdversarialAlgorithm.__init__-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AdversarialAlgorithm.__init__-173"><a href="#AdversarialAlgorithm.__init__-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="AdversarialAlgorithm.__init__-174"><a href="#AdversarialAlgorithm.__init__-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="AdversarialAlgorithm.__init__-175"><a href="#AdversarialAlgorithm.__init__-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span><span id="AdversarialAlgorithm.__init__-176"><a href="#AdversarialAlgorithm.__init__-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_smoothing_rate</span> <span class="o">=</span> <span class="n">smoothing_rate</span>
</span><span id="AdversarialAlgorithm.__init__-177"><a href="#AdversarialAlgorithm.__init__-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span> <span class="o">=</span> <span class="n">latent_mean_distribution</span>
</span><span id="AdversarialAlgorithm.__init__-178"><a href="#AdversarialAlgorithm.__init__-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span> <span class="o">=</span> <span class="n">latent_stander_deviation</span>
</span><span id="AdversarialAlgorithm.__init__-179"><a href="#AdversarialAlgorithm.__init__-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">=</span> <span class="n">file_name_discriminator</span>
</span><span id="AdversarialAlgorithm.__init__-180"><a href="#AdversarialAlgorithm.__init__-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">=</span> <span class="n">file_name_generator</span>
</span><span id="AdversarialAlgorithm.__init__-181"><a href="#AdversarialAlgorithm.__init__-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span> <span class="o">=</span> <span class="n">models_saved_path</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.compile" class="classattr">
                                        <input id="AdversarialAlgorithm.compile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compile</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">optimizer_generator</span>,</span><span class="param">	<span class="n">optimizer_discriminator</span>,</span><span class="param">	<span class="n">loss_generator</span>,</span><span class="param">	<span class="n">loss_discriminator</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.compile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.compile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.compile-184"><a href="#AdversarialAlgorithm.compile-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.compile-185"><a href="#AdversarialAlgorithm.compile-185"><span class="linenos">185</span></a>                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.compile-186"><a href="#AdversarialAlgorithm.compile-186"><span class="linenos">186</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.compile-187"><a href="#AdversarialAlgorithm.compile-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.compile-188"><a href="#AdversarialAlgorithm.compile-188"><span class="linenos">188</span></a><span class="sd">        Compiles the adversarial algorithm by setting optimizers and loss functions for both generator and discriminator.</span>
</span><span id="AdversarialAlgorithm.compile-189"><a href="#AdversarialAlgorithm.compile-189"><span class="linenos">189</span></a>
</span><span id="AdversarialAlgorithm.compile-190"><a href="#AdversarialAlgorithm.compile-190"><span class="linenos">190</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm.compile-191"><a href="#AdversarialAlgorithm.compile-191"><span class="linenos">191</span></a><span class="sd">            optimizer_generator (Optimizer): Optimizer for the generator.</span>
</span><span id="AdversarialAlgorithm.compile-192"><a href="#AdversarialAlgorithm.compile-192"><span class="linenos">192</span></a><span class="sd">            optimizer_discriminator (Optimizer): Optimizer for the discriminator.</span>
</span><span id="AdversarialAlgorithm.compile-193"><a href="#AdversarialAlgorithm.compile-193"><span class="linenos">193</span></a><span class="sd">            loss_generator (function): Generator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm.compile-194"><a href="#AdversarialAlgorithm.compile-194"><span class="linenos">194</span></a><span class="sd">            loss_discriminator (function): Discriminator&#39;s loss function.</span>
</span><span id="AdversarialAlgorithm.compile-195"><a href="#AdversarialAlgorithm.compile-195"><span class="linenos">195</span></a><span class="sd">            *args, **kwargs: Additional arguments.</span>
</span><span id="AdversarialAlgorithm.compile-196"><a href="#AdversarialAlgorithm.compile-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.compile-197"><a href="#AdversarialAlgorithm.compile-197"><span class="linenos">197</span></a>
</span><span id="AdversarialAlgorithm.compile-198"><a href="#AdversarialAlgorithm.compile-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span><span id="AdversarialAlgorithm.compile-199"><a href="#AdversarialAlgorithm.compile-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span><span id="AdversarialAlgorithm.compile-200"><a href="#AdversarialAlgorithm.compile-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span><span id="AdversarialAlgorithm.compile-201"><a href="#AdversarialAlgorithm.compile-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span></pre></div>


            <div class="docstring"><p>Configures the model for training.</p>

<p>Example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">BinaryAccuracy</span><span class="p">(),</span>
        <span class="n">keras</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">FalseNegatives</span><span class="p">(),</span>
    <span class="p">],</span>
<span class="p">)</span>
</code></pre>
</div>

<p>Args:
    optimizer: String (name of optimizer) or optimizer instance. See
        <code>keras.optimizers</code>.
    loss: Loss function. May be a string (name of loss function), or
        a <code>keras.losses.Loss</code> instance. See <code>keras.losses</code>. A
        loss function is any callable with the signature
        <code>loss = fn(y_true, y_pred)</code>, where <code>y_true</code> are the ground truth
        values, and <code>y_pred</code> are the model's predictions.
        <code>y_true</code> should have shape <code>(batch_size, d0, .. dN)</code>
        (except in the case of sparse loss functions such as
        sparse categorical crossentropy which expects integer arrays of
        shape <code>(batch_size, d0, .. dN-1)</code>).
        <code>y_pred</code> should have shape <code>(batch_size, d0, .. dN)</code>.
        The loss function should return a float tensor.
    loss_weights: Optional list or dictionary specifying scalar
        coefficients (Python floats) to weight the loss contributions of
        different model outputs. The loss value that will be minimized
        by the model will then be the *weighted sum* of all individual
        losses, weighted by the <code>loss_weights</code> coefficients.  If a list,
        it is expected to have a 1:1 mapping to the model's outputs. If
        a dict, it is expected to map output names (strings) to scalar
        coefficients.
    metrics: List of metrics to be evaluated by the model during
        training and testing. Each of this can be a string (name of a
        built-in function), function or a <code>keras.metrics.Metric</code>
        instance. See <code>keras.metrics</code>. Typically you will use
        <code>metrics=['accuracy']</code>. A function is any callable with the
        signature <code>result = fn(y_true, _pred)</code>. To specify different
        metrics for different outputs of a multi-output model, you could
        also pass a dictionary, such as
        <code>metrics={'a':'accuracy', 'b':['accuracy', 'mse']}</code>.
        You can also pass a list to specify a metric or a list of
        metrics for each output, such as
        <code>metrics=[['accuracy'], ['accuracy', 'mse']]</code>
        or <code>metrics=['accuracy', ['accuracy', 'mse']]</code>. When you pass
        the strings 'accuracy' or 'acc', we convert this to one of
        <code>keras.metrics.BinaryAccuracy</code>,
        <code>keras.metrics.CategoricalAccuracy</code>,
        <code>keras.metrics.SparseCategoricalAccuracy</code> based on the
        shapes of the targets and of the model output. A similar
        conversion is done for the strings <code>"crossentropy"</code>
        and <code>"ce"</code> as well.
        The metrics passed here are evaluated without sample weighting;
        if you would like sample weighting to apply, you can specify
        your metrics via the <code>weighted_metrics</code> argument instead.
    weighted_metrics: List of metrics to be evaluated and weighted by
        <code>sample_weight</code> or <code>class_weight</code> during training and testing.
    run_eagerly: Bool. If <code>True</code>, this model's forward pass
         will never be compiled. It is recommended to leave this
         as <code>False</code> when training (for best performance),
         and to set it to <code>True</code> when debugging.
    steps_per_execution: Int. The number of batches to run
        during each a single compiled function call. Running multiple
        batches inside a single compiled function call can
        greatly improve performance on TPUs or small models with a large
        Python overhead. At most, one full epoch will be run each
        execution. If a number larger than the size of the epoch is
        passed, the execution will be truncated to the size of the
        epoch. Note that if <code><a href="#AdversarialAlgorithm.steps_per_execution">steps_per_execution</a></code> is set to <code>N</code>,
        <code>Callback.on_batch_begin</code> and <code>Callback.on_batch_end</code> methods
        will only be called every <code>N</code> batches (i.e. before/after
        each compiled function execution).
        Not supported with the PyTorch backend.
    jit_compile: Bool or <code>"auto"</code>. Whether to use XLA compilation when
        compiling a model. For <code>jax</code> and <code>tensorflow</code> backends,
        <code>jit_compile="auto"</code> enables XLA compilation if the model
        supports it, and disabled otherwise.
        For <code>torch</code> backend, <code>"auto"</code> will default to eager
        execution and <code>jit_compile=True</code> will run with <code>torch.compile</code>
        with the <code>"inductor"</code> backend.
    auto_scale_loss: Bool. If <code>True</code> and the model dtype policy is
        <code>"mixed_float16"</code>, the passed optimizer will be automatically
        wrapped in a <code>LossScaleOptimizer</code>, which will dynamically
        scale the loss to prevent underflow.</p>
</div>


                            </div>
                            <div id="AdversarialAlgorithm.train_step" class="classattr">
                                        <input id="AdversarialAlgorithm.train_step-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-tensorflow.function">@tensorflow.function</div>

        <span class="def">def</span>
        <span class="name">train_step</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">batch</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.train_step-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.train_step"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.train_step-203"><a href="#AdversarialAlgorithm.train_step-203"><span class="linenos">203</span></a>    <span class="nd">@tensorflow</span><span class="o">.</span><span class="n">function</span>
</span><span id="AdversarialAlgorithm.train_step-204"><a href="#AdversarialAlgorithm.train_step-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.train_step-205"><a href="#AdversarialAlgorithm.train_step-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.train_step-206"><a href="#AdversarialAlgorithm.train_step-206"><span class="linenos">206</span></a><span class="sd">        Performs a single training step for both generator and discriminator.</span>
</span><span id="AdversarialAlgorithm.train_step-207"><a href="#AdversarialAlgorithm.train_step-207"><span class="linenos">207</span></a><span class="sd">        This function is decorated with @tensorflow.function to optimize graph execution.</span>
</span><span id="AdversarialAlgorithm.train_step-208"><a href="#AdversarialAlgorithm.train_step-208"><span class="linenos">208</span></a>
</span><span id="AdversarialAlgorithm.train_step-209"><a href="#AdversarialAlgorithm.train_step-209"><span class="linenos">209</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm.train_step-210"><a href="#AdversarialAlgorithm.train_step-210"><span class="linenos">210</span></a><span class="sd">            batch (tuple): A tuple containing real features (input data) and their corresponding labels.</span>
</span><span id="AdversarialAlgorithm.train_step-211"><a href="#AdversarialAlgorithm.train_step-211"><span class="linenos">211</span></a>
</span><span id="AdversarialAlgorithm.train_step-212"><a href="#AdversarialAlgorithm.train_step-212"><span class="linenos">212</span></a><span class="sd">        Returns:</span>
</span><span id="AdversarialAlgorithm.train_step-213"><a href="#AdversarialAlgorithm.train_step-213"><span class="linenos">213</span></a><span class="sd">            dict: A dictionary containing the loss values for both generator (loss_g) and discriminator (loss_d).</span>
</span><span id="AdversarialAlgorithm.train_step-214"><a href="#AdversarialAlgorithm.train_step-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.train_step-215"><a href="#AdversarialAlgorithm.train_step-215"><span class="linenos">215</span></a>
</span><span id="AdversarialAlgorithm.train_step-216"><a href="#AdversarialAlgorithm.train_step-216"><span class="linenos">216</span></a>        <span class="c1"># Unpack the batch into real features and real labels</span>
</span><span id="AdversarialAlgorithm.train_step-217"><a href="#AdversarialAlgorithm.train_step-217"><span class="linenos">217</span></a>        <span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">batch</span>
</span><span id="AdversarialAlgorithm.train_step-218"><a href="#AdversarialAlgorithm.train_step-218"><span class="linenos">218</span></a>
</span><span id="AdversarialAlgorithm.train_step-219"><a href="#AdversarialAlgorithm.train_step-219"><span class="linenos">219</span></a>        <span class="c1"># Get the current batch size (number of samples in this batch)</span>
</span><span id="AdversarialAlgorithm.train_step-220"><a href="#AdversarialAlgorithm.train_step-220"><span class="linenos">220</span></a>        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">real_feature</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="AdversarialAlgorithm.train_step-221"><a href="#AdversarialAlgorithm.train_step-221"><span class="linenos">221</span></a>
</span><span id="AdversarialAlgorithm.train_step-222"><a href="#AdversarialAlgorithm.train_step-222"><span class="linenos">222</span></a>        <span class="c1"># Expand the label tensor to match the expected shape (add a new axis at the end)</span>
</span><span id="AdversarialAlgorithm.train_step-223"><a href="#AdversarialAlgorithm.train_step-223"><span class="linenos">223</span></a>        <span class="n">real_samples_label</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">real_samples_label</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-224"><a href="#AdversarialAlgorithm.train_step-224"><span class="linenos">224</span></a>
</span><span id="AdversarialAlgorithm.train_step-225"><a href="#AdversarialAlgorithm.train_step-225"><span class="linenos">225</span></a>        <span class="c1"># Sample random noise vectors (latent space) for the generator input</span>
</span><span id="AdversarialAlgorithm.train_step-226"><a href="#AdversarialAlgorithm.train_step-226"><span class="linenos">226</span></a>        <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-227"><a href="#AdversarialAlgorithm.train_step-227"><span class="linenos">227</span></a>
</span><span id="AdversarialAlgorithm.train_step-228"><a href="#AdversarialAlgorithm.train_step-228"><span class="linenos">228</span></a>        <span class="c1"># Use the generator to create synthetic (fake) features using noise and real labels (conditioning)</span>
</span><span id="AdversarialAlgorithm.train_step-229"><a href="#AdversarialAlgorithm.train_step-229"><span class="linenos">229</span></a>        <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-230"><a href="#AdversarialAlgorithm.train_step-230"><span class="linenos">230</span></a>
</span><span id="AdversarialAlgorithm.train_step-231"><a href="#AdversarialAlgorithm.train_step-231"><span class="linenos">231</span></a>        <span class="c1"># Start discriminator training within a gradient tape context to track gradients</span>
</span><span id="AdversarialAlgorithm.train_step-232"><a href="#AdversarialAlgorithm.train_step-232"><span class="linenos">232</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">discriminator_gradient</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.train_step-233"><a href="#AdversarialAlgorithm.train_step-233"><span class="linenos">233</span></a>            <span class="c1"># Get discriminator prediction on real samples (real features + real labels)</span>
</span><span id="AdversarialAlgorithm.train_step-234"><a href="#AdversarialAlgorithm.train_step-234"><span class="linenos">234</span></a>            <span class="n">label_predicted_real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">real_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-235"><a href="#AdversarialAlgorithm.train_step-235"><span class="linenos">235</span></a>
</span><span id="AdversarialAlgorithm.train_step-236"><a href="#AdversarialAlgorithm.train_step-236"><span class="linenos">236</span></a>            <span class="c1"># Get discriminator prediction on synthetic (fake) samples (synthetic features + real labels)</span>
</span><span id="AdversarialAlgorithm.train_step-237"><a href="#AdversarialAlgorithm.train_step-237"><span class="linenos">237</span></a>            <span class="n">label_predicted_synthetic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-238"><a href="#AdversarialAlgorithm.train_step-238"><span class="linenos">238</span></a>
</span><span id="AdversarialAlgorithm.train_step-239"><a href="#AdversarialAlgorithm.train_step-239"><span class="linenos">239</span></a>            <span class="c1"># Concatenate predictions for real and synthetic samples into a single tensor</span>
</span><span id="AdversarialAlgorithm.train_step-240"><a href="#AdversarialAlgorithm.train_step-240"><span class="linenos">240</span></a>            <span class="n">label_predicted_all_samples</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">label_predicted_real</span><span class="p">,</span> <span class="n">label_predicted_synthetic</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-241"><a href="#AdversarialAlgorithm.train_step-241"><span class="linenos">241</span></a>
</span><span id="AdversarialAlgorithm.train_step-242"><a href="#AdversarialAlgorithm.train_step-242"><span class="linenos">242</span></a>            <span class="c1"># Create the ground-truth labels for the discriminator</span>
</span><span id="AdversarialAlgorithm.train_step-243"><a href="#AdversarialAlgorithm.train_step-243"><span class="linenos">243</span></a>            <span class="c1"># Real samples should be labeled as 0, synthetic samples as 1</span>
</span><span id="AdversarialAlgorithm.train_step-244"><a href="#AdversarialAlgorithm.train_step-244"><span class="linenos">244</span></a>            <span class="n">list_all_labels_predicted</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="AdversarialAlgorithm.train_step-245"><a href="#AdversarialAlgorithm.train_step-245"><span class="linenos">245</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">),</span>  <span class="c1"># Real labels = 0</span>
</span><span id="AdversarialAlgorithm.train_step-246"><a href="#AdversarialAlgorithm.train_step-246"><span class="linenos">246</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">)</span>  <span class="c1"># Fake labels = 1</span>
</span><span id="AdversarialAlgorithm.train_step-247"><a href="#AdversarialAlgorithm.train_step-247"><span class="linenos">247</span></a>            <span class="p">]</span>
</span><span id="AdversarialAlgorithm.train_step-248"><a href="#AdversarialAlgorithm.train_step-248"><span class="linenos">248</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_all_labels_predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-249"><a href="#AdversarialAlgorithm.train_step-249"><span class="linenos">249</span></a>
</span><span id="AdversarialAlgorithm.train_step-250"><a href="#AdversarialAlgorithm.train_step-250"><span class="linenos">250</span></a>            <span class="c1"># Label smoothing for regularization</span>
</span><span id="AdversarialAlgorithm.train_step-251"><a href="#AdversarialAlgorithm.train_step-251"><span class="linenos">251</span></a>            <span class="c1"># Add random noise to real labels (smooth them slightly downwards)</span>
</span><span id="AdversarialAlgorithm.train_step-252"><a href="#AdversarialAlgorithm.train_step-252"><span class="linenos">252</span></a>            <span class="n">smooth_tensor_real_data</span> <span class="o">=</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_real</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-253"><a href="#AdversarialAlgorithm.train_step-253"><span class="linenos">253</span></a>
</span><span id="AdversarialAlgorithm.train_step-254"><a href="#AdversarialAlgorithm.train_step-254"><span class="linenos">254</span></a>            <span class="c1"># Add random noise to fake labels (smooth them slightly upwards)</span>
</span><span id="AdversarialAlgorithm.train_step-255"><a href="#AdversarialAlgorithm.train_step-255"><span class="linenos">255</span></a>            <span class="n">smooth_tensor_synthetic_data</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm.train_step-256"><a href="#AdversarialAlgorithm.train_step-256"><span class="linenos">256</span></a>                <span class="n">tensorflow</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">label_predicted_synthetic</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-257"><a href="#AdversarialAlgorithm.train_step-257"><span class="linenos">257</span></a>
</span><span id="AdversarialAlgorithm.train_step-258"><a href="#AdversarialAlgorithm.train_step-258"><span class="linenos">258</span></a>            <span class="c1"># Combine smoothed noise into the label tensor</span>
</span><span id="AdversarialAlgorithm.train_step-259"><a href="#AdversarialAlgorithm.train_step-259"><span class="linenos">259</span></a>            <span class="n">tensor_labels_predicted</span> <span class="o">+=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm.train_step-260"><a href="#AdversarialAlgorithm.train_step-260"><span class="linenos">260</span></a>                <span class="p">[</span><span class="n">smooth_tensor_real_data</span><span class="p">,</span> <span class="n">smooth_tensor_synthetic_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
</span><span id="AdversarialAlgorithm.train_step-261"><a href="#AdversarialAlgorithm.train_step-261"><span class="linenos">261</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-262"><a href="#AdversarialAlgorithm.train_step-262"><span class="linenos">262</span></a>
</span><span id="AdversarialAlgorithm.train_step-263"><a href="#AdversarialAlgorithm.train_step-263"><span class="linenos">263</span></a>            <span class="c1"># Compute the discriminator loss comparing predicted labels to (smoothed) ground-truth labels</span>
</span><span id="AdversarialAlgorithm.train_step-264"><a href="#AdversarialAlgorithm.train_step-264"><span class="linenos">264</span></a>            <span class="n">loss_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span><span class="p">(</span><span class="n">tensor_labels_predicted</span><span class="p">,</span> <span class="n">label_predicted_all_samples</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-265"><a href="#AdversarialAlgorithm.train_step-265"><span class="linenos">265</span></a>
</span><span id="AdversarialAlgorithm.train_step-266"><a href="#AdversarialAlgorithm.train_step-266"><span class="linenos">266</span></a>        <span class="c1"># Compute gradients of the discriminator loss with respect to discriminator trainable weights</span>
</span><span id="AdversarialAlgorithm.train_step-267"><a href="#AdversarialAlgorithm.train_step-267"><span class="linenos">267</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">discriminator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-268"><a href="#AdversarialAlgorithm.train_step-268"><span class="linenos">268</span></a>
</span><span id="AdversarialAlgorithm.train_step-269"><a href="#AdversarialAlgorithm.train_step-269"><span class="linenos">269</span></a>        <span class="c1"># Apply the computed gradients to update discriminator weights</span>
</span><span id="AdversarialAlgorithm.train_step-270"><a href="#AdversarialAlgorithm.train_step-270"><span class="linenos">270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-271"><a href="#AdversarialAlgorithm.train_step-271"><span class="linenos">271</span></a>
</span><span id="AdversarialAlgorithm.train_step-272"><a href="#AdversarialAlgorithm.train_step-272"><span class="linenos">272</span></a>        <span class="c1"># Start generator training within a gradient tape context to track gradients</span>
</span><span id="AdversarialAlgorithm.train_step-273"><a href="#AdversarialAlgorithm.train_step-273"><span class="linenos">273</span></a>        <span class="k">with</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">generator_gradient</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.train_step-274"><a href="#AdversarialAlgorithm.train_step-274"><span class="linenos">274</span></a>            <span class="c1"># Generate synthetic samples using the generator (in training mode)</span>
</span><span id="AdversarialAlgorithm.train_step-275"><a href="#AdversarialAlgorithm.train_step-275"><span class="linenos">275</span></a>            <span class="n">latent_space</span> <span class="o">=</span> <span class="n">tensorflow</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-276"><a href="#AdversarialAlgorithm.train_step-276"><span class="linenos">276</span></a>            <span class="n">synthetic_feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="p">([</span><span class="n">latent_space</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-277"><a href="#AdversarialAlgorithm.train_step-277"><span class="linenos">277</span></a>
</span><span id="AdversarialAlgorithm.train_step-278"><a href="#AdversarialAlgorithm.train_step-278"><span class="linenos">278</span></a>            <span class="c1"># Get discriminator predictions for the synthetic samples (real labels used for conditioning)</span>
</span><span id="AdversarialAlgorithm.train_step-279"><a href="#AdversarialAlgorithm.train_step-279"><span class="linenos">279</span></a>            <span class="n">predicted_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="p">([</span><span class="n">synthetic_feature</span><span class="p">,</span> <span class="n">real_samples_label</span><span class="p">],</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-280"><a href="#AdversarialAlgorithm.train_step-280"><span class="linenos">280</span></a>
</span><span id="AdversarialAlgorithm.train_step-281"><a href="#AdversarialAlgorithm.train_step-281"><span class="linenos">281</span></a>            <span class="c1"># Compute the generator loss</span>
</span><span id="AdversarialAlgorithm.train_step-282"><a href="#AdversarialAlgorithm.train_step-282"><span class="linenos">282</span></a>            <span class="c1"># The generator wants the discriminator to classify synthetic data as real (label = 0)</span>
</span><span id="AdversarialAlgorithm.train_step-283"><a href="#AdversarialAlgorithm.train_step-283"><span class="linenos">283</span></a>            <span class="n">total_loss_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span><span class="p">(</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">predicted_labels</span><span class="p">),</span> <span class="n">predicted_labels</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-284"><a href="#AdversarialAlgorithm.train_step-284"><span class="linenos">284</span></a>
</span><span id="AdversarialAlgorithm.train_step-285"><a href="#AdversarialAlgorithm.train_step-285"><span class="linenos">285</span></a>        <span class="c1"># Compute gradients of the generator loss with respect to generator trainable weights</span>
</span><span id="AdversarialAlgorithm.train_step-286"><a href="#AdversarialAlgorithm.train_step-286"><span class="linenos">286</span></a>        <span class="n">gradient_tape_loss</span> <span class="o">=</span> <span class="n">generator_gradient</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">total_loss_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.train_step-287"><a href="#AdversarialAlgorithm.train_step-287"><span class="linenos">287</span></a>
</span><span id="AdversarialAlgorithm.train_step-288"><a href="#AdversarialAlgorithm.train_step-288"><span class="linenos">288</span></a>        <span class="c1"># Apply the computed gradients to update generator weights</span>
</span><span id="AdversarialAlgorithm.train_step-289"><a href="#AdversarialAlgorithm.train_step-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gradient_tape_loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">trainable_variables</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.train_step-290"><a href="#AdversarialAlgorithm.train_step-290"><span class="linenos">290</span></a>
</span><span id="AdversarialAlgorithm.train_step-291"><a href="#AdversarialAlgorithm.train_step-291"><span class="linenos">291</span></a>        <span class="c1"># Return a dictionary containing both losses for tracking</span>
</span><span id="AdversarialAlgorithm.train_step-292"><a href="#AdversarialAlgorithm.train_step-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;loss_d&quot;</span><span class="p">:</span> <span class="n">loss_value</span><span class="p">,</span> <span class="s2">&quot;loss_g&quot;</span><span class="p">:</span> <span class="n">total_loss_g</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Performs a single training step for both generator and discriminator.
This function is decorated with @tensorflow.function to optimize graph execution.</p>

<p>Args:
    batch (tuple): A tuple containing real features (input data) and their corresponding labels.</p>

<p>Returns:
    dict: A dictionary containing the loss values for both generator (loss_g) and discriminator (loss_d).</p>
</div>


                            </div>
                            <div id="AdversarialAlgorithm.get_samples" class="classattr">
                                        <input id="AdversarialAlgorithm.get_samples-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_samples</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">number_samples_per_class</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.get_samples-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.get_samples"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.get_samples-294"><a href="#AdversarialAlgorithm.get_samples-294"><span class="linenos">294</span></a>    <span class="k">def</span> <span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number_samples_per_class</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.get_samples-295"><a href="#AdversarialAlgorithm.get_samples-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.get_samples-296"><a href="#AdversarialAlgorithm.get_samples-296"><span class="linenos">296</span></a><span class="sd">        Generates synthetic data samples for each specified class using the trained generator.</span>
</span><span id="AdversarialAlgorithm.get_samples-297"><a href="#AdversarialAlgorithm.get_samples-297"><span class="linenos">297</span></a>
</span><span id="AdversarialAlgorithm.get_samples-298"><a href="#AdversarialAlgorithm.get_samples-298"><span class="linenos">298</span></a><span class="sd">        Args:</span>
</span><span id="AdversarialAlgorithm.get_samples-299"><a href="#AdversarialAlgorithm.get_samples-299"><span class="linenos">299</span></a><span class="sd">            number_samples_per_class (dict):</span>
</span><span id="AdversarialAlgorithm.get_samples-300"><a href="#AdversarialAlgorithm.get_samples-300"><span class="linenos">300</span></a><span class="sd">                A dictionary specifying the number of synthetic samples to generate per class.</span>
</span><span id="AdversarialAlgorithm.get_samples-301"><a href="#AdversarialAlgorithm.get_samples-301"><span class="linenos">301</span></a><span class="sd">                Expected structure:</span>
</span><span id="AdversarialAlgorithm.get_samples-302"><a href="#AdversarialAlgorithm.get_samples-302"><span class="linenos">302</span></a><span class="sd">                {</span>
</span><span id="AdversarialAlgorithm.get_samples-303"><a href="#AdversarialAlgorithm.get_samples-303"><span class="linenos">303</span></a><span class="sd">                    &quot;classes&quot;: {class_label: number_of_samples, ...},</span>
</span><span id="AdversarialAlgorithm.get_samples-304"><a href="#AdversarialAlgorithm.get_samples-304"><span class="linenos">304</span></a><span class="sd">                    &quot;number_classes&quot;: total_number_of_classes</span>
</span><span id="AdversarialAlgorithm.get_samples-305"><a href="#AdversarialAlgorithm.get_samples-305"><span class="linenos">305</span></a><span class="sd">                }</span>
</span><span id="AdversarialAlgorithm.get_samples-306"><a href="#AdversarialAlgorithm.get_samples-306"><span class="linenos">306</span></a>
</span><span id="AdversarialAlgorithm.get_samples-307"><a href="#AdversarialAlgorithm.get_samples-307"><span class="linenos">307</span></a><span class="sd">        Returns:</span>
</span><span id="AdversarialAlgorithm.get_samples-308"><a href="#AdversarialAlgorithm.get_samples-308"><span class="linenos">308</span></a><span class="sd">            dict:</span>
</span><span id="AdversarialAlgorithm.get_samples-309"><a href="#AdversarialAlgorithm.get_samples-309"><span class="linenos">309</span></a><span class="sd">                A dictionary where each key is a class label and the value is an array of generated samples for that class.</span>
</span><span id="AdversarialAlgorithm.get_samples-310"><a href="#AdversarialAlgorithm.get_samples-310"><span class="linenos">310</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdversarialAlgorithm.get_samples-311"><a href="#AdversarialAlgorithm.get_samples-311"><span class="linenos">311</span></a>
</span><span id="AdversarialAlgorithm.get_samples-312"><a href="#AdversarialAlgorithm.get_samples-312"><span class="linenos">312</span></a>        <span class="c1"># Initialize an empty dictionary to store generated samples grouped by class</span>
</span><span id="AdversarialAlgorithm.get_samples-313"><a href="#AdversarialAlgorithm.get_samples-313"><span class="linenos">313</span></a>        <span class="n">generated_data</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="AdversarialAlgorithm.get_samples-314"><a href="#AdversarialAlgorithm.get_samples-314"><span class="linenos">314</span></a>
</span><span id="AdversarialAlgorithm.get_samples-315"><a href="#AdversarialAlgorithm.get_samples-315"><span class="linenos">315</span></a>        <span class="c1"># Iterate over each class and the corresponding number of samples to generate</span>
</span><span id="AdversarialAlgorithm.get_samples-316"><a href="#AdversarialAlgorithm.get_samples-316"><span class="linenos">316</span></a>        <span class="k">for</span> <span class="n">label_class</span><span class="p">,</span> <span class="n">number_instances</span> <span class="ow">in</span> <span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;classes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdversarialAlgorithm.get_samples-317"><a href="#AdversarialAlgorithm.get_samples-317"><span class="linenos">317</span></a>            <span class="c1"># Create one-hot encoded labels for all generated samples in this class</span>
</span><span id="AdversarialAlgorithm.get_samples-318"><a href="#AdversarialAlgorithm.get_samples-318"><span class="linenos">318</span></a>            <span class="c1"># Example: if label_class = 2 and number_instances = 5, this will generate:</span>
</span><span id="AdversarialAlgorithm.get_samples-319"><a href="#AdversarialAlgorithm.get_samples-319"><span class="linenos">319</span></a>            <span class="c1"># [[0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1], [0, 0, 1]]</span>
</span><span id="AdversarialAlgorithm.get_samples-320"><a href="#AdversarialAlgorithm.get_samples-320"><span class="linenos">320</span></a>            <span class="n">label_samples_generated</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm.get_samples-321"><a href="#AdversarialAlgorithm.get_samples-321"><span class="linenos">321</span></a>                <span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_instances</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.get_samples-322"><a href="#AdversarialAlgorithm.get_samples-322"><span class="linenos">322</span></a>                <span class="n">num_classes</span><span class="o">=</span><span class="n">number_samples_per_class</span><span class="p">[</span><span class="s2">&quot;number_classes&quot;</span><span class="p">]</span>
</span><span id="AdversarialAlgorithm.get_samples-323"><a href="#AdversarialAlgorithm.get_samples-323"><span class="linenos">323</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm.get_samples-324"><a href="#AdversarialAlgorithm.get_samples-324"><span class="linenos">324</span></a>
</span><span id="AdversarialAlgorithm.get_samples-325"><a href="#AdversarialAlgorithm.get_samples-325"><span class="linenos">325</span></a>            <span class="c1"># Generate random noise vectors (latent vectors) for each sample</span>
</span><span id="AdversarialAlgorithm.get_samples-326"><a href="#AdversarialAlgorithm.get_samples-326"><span class="linenos">326</span></a>            <span class="c1"># Shape: (number_instances, latent_dimension)</span>
</span><span id="AdversarialAlgorithm.get_samples-327"><a href="#AdversarialAlgorithm.get_samples-327"><span class="linenos">327</span></a>            <span class="n">latent_noise</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
</span><span id="AdversarialAlgorithm.get_samples-328"><a href="#AdversarialAlgorithm.get_samples-328"><span class="linenos">328</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_mean_distribution</span><span class="p">,</span>  <span class="c1"># Mean of the latent space distribution</span>
</span><span id="AdversarialAlgorithm.get_samples-329"><a href="#AdversarialAlgorithm.get_samples-329"><span class="linenos">329</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_latent_stander_deviation</span><span class="p">,</span>  <span class="c1"># Standard deviation of the latent space distribution</span>
</span><span id="AdversarialAlgorithm.get_samples-330"><a href="#AdversarialAlgorithm.get_samples-330"><span class="linenos">330</span></a>                <span class="p">(</span><span class="n">number_instances</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.get_samples-331"><a href="#AdversarialAlgorithm.get_samples-331"><span class="linenos">331</span></a>            <span class="p">)</span>
</span><span id="AdversarialAlgorithm.get_samples-332"><a href="#AdversarialAlgorithm.get_samples-332"><span class="linenos">332</span></a>
</span><span id="AdversarialAlgorithm.get_samples-333"><a href="#AdversarialAlgorithm.get_samples-333"><span class="linenos">333</span></a>            <span class="c1"># Use the generator to produce synthetic samples conditioned on the class labels</span>
</span><span id="AdversarialAlgorithm.get_samples-334"><a href="#AdversarialAlgorithm.get_samples-334"><span class="linenos">334</span></a>            <span class="c1"># Inputs: latent noise vectors and one-hot class labels</span>
</span><span id="AdversarialAlgorithm.get_samples-335"><a href="#AdversarialAlgorithm.get_samples-335"><span class="linenos">335</span></a>            <span class="c1"># &#39;verbose=0&#39; suppresses console output from the predict call</span>
</span><span id="AdversarialAlgorithm.get_samples-336"><a href="#AdversarialAlgorithm.get_samples-336"><span class="linenos">336</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">latent_noise</span><span class="p">,</span> <span class="n">label_samples_generated</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.get_samples-337"><a href="#AdversarialAlgorithm.get_samples-337"><span class="linenos">337</span></a>
</span><span id="AdversarialAlgorithm.get_samples-338"><a href="#AdversarialAlgorithm.get_samples-338"><span class="linenos">338</span></a>            <span class="c1"># Round generated sample values to nearest integer (useful if generating binary data, like images with pixel values 0/1)</span>
</span><span id="AdversarialAlgorithm.get_samples-339"><a href="#AdversarialAlgorithm.get_samples-339"><span class="linenos">339</span></a>            <span class="n">generated_samples</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">generated_samples</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.get_samples-340"><a href="#AdversarialAlgorithm.get_samples-340"><span class="linenos">340</span></a>
</span><span id="AdversarialAlgorithm.get_samples-341"><a href="#AdversarialAlgorithm.get_samples-341"><span class="linenos">341</span></a>            <span class="c1"># Store the generated samples in the dictionary under the corresponding class label</span>
</span><span id="AdversarialAlgorithm.get_samples-342"><a href="#AdversarialAlgorithm.get_samples-342"><span class="linenos">342</span></a>            <span class="n">generated_data</span><span class="p">[</span><span class="n">label_class</span><span class="p">]</span> <span class="o">=</span> <span class="n">generated_samples</span>
</span><span id="AdversarialAlgorithm.get_samples-343"><a href="#AdversarialAlgorithm.get_samples-343"><span class="linenos">343</span></a>
</span><span id="AdversarialAlgorithm.get_samples-344"><a href="#AdversarialAlgorithm.get_samples-344"><span class="linenos">344</span></a>        <span class="c1"># Return the dictionary containing all generated samples, grouped by class</span>
</span><span id="AdversarialAlgorithm.get_samples-345"><a href="#AdversarialAlgorithm.get_samples-345"><span class="linenos">345</span></a>        <span class="k">return</span> <span class="n">generated_data</span>
</span></pre></div>


            <div class="docstring"><p>Generates synthetic data samples for each specified class using the trained generator.</p>

<p>Args:
    number_samples_per_class (dict):
        A dictionary specifying the number of synthetic samples to generate per class.
        Expected structure:
        {
            "classes": {class_label: number_of_samples, ...},
            "number_classes": total_number_of_classes
        }</p>

<p>Returns:
    dict:
        A dictionary where each key is a class label and the value is an array of generated samples for that class.</p>
</div>


                            </div>
                            <div id="AdversarialAlgorithm.save_model" class="classattr">
                                        <input id="AdversarialAlgorithm.save_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path_output</span>, </span><span class="param"><span class="n">k_fold</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.save_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.save_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.save_model-347"><a href="#AdversarialAlgorithm.save_model-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">save_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.save_model-348"><a href="#AdversarialAlgorithm.save_model-348"><span class="linenos">348</span></a>
</span><span id="AdversarialAlgorithm.save_model-349"><a href="#AdversarialAlgorithm.save_model-349"><span class="linenos">349</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.save_model-350"><a href="#AdversarialAlgorithm.save_model-350"><span class="linenos">350</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting to save Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-351"><a href="#AdversarialAlgorithm.save_model-351"><span class="linenos">351</span></a>
</span><span id="AdversarialAlgorithm.save_model-352"><a href="#AdversarialAlgorithm.save_model-352"><span class="linenos">352</span></a>            <span class="c1"># Create directory for saving models</span>
</span><span id="AdversarialAlgorithm.save_model-353"><a href="#AdversarialAlgorithm.save_model-353"><span class="linenos">353</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-354"><a href="#AdversarialAlgorithm.save_model-354"><span class="linenos">354</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_directory</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-355"><a href="#AdversarialAlgorithm.save_model-355"><span class="linenos">355</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_directory</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-356"><a href="#AdversarialAlgorithm.save_model-356"><span class="linenos">356</span></a>
</span><span id="AdversarialAlgorithm.save_model-357"><a href="#AdversarialAlgorithm.save_model-357"><span class="linenos">357</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="AdversarialAlgorithm.save_model-358"><a href="#AdversarialAlgorithm.save_model-358"><span class="linenos">358</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-359"><a href="#AdversarialAlgorithm.save_model-359"><span class="linenos">359</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-360"><a href="#AdversarialAlgorithm.save_model-360"><span class="linenos">360</span></a>
</span><span id="AdversarialAlgorithm.save_model-361"><a href="#AdversarialAlgorithm.save_model-361"><span class="linenos">361</span></a>            <span class="c1"># Directory for the current fold</span>
</span><span id="AdversarialAlgorithm.save_model-362"><a href="#AdversarialAlgorithm.save_model-362"><span class="linenos">362</span></a>            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="s2">&quot;fold_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-363"><a href="#AdversarialAlgorithm.save_model-363"><span class="linenos">363</span></a>            <span class="n">Path</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-364"><a href="#AdversarialAlgorithm.save_model-364"><span class="linenos">364</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Created/verified fold directory at: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path_model</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-365"><a href="#AdversarialAlgorithm.save_model-365"><span class="linenos">365</span></a>
</span><span id="AdversarialAlgorithm.save_model-366"><a href="#AdversarialAlgorithm.save_model-366"><span class="linenos">366</span></a>            <span class="c1"># Full paths for the model files</span>
</span><span id="AdversarialAlgorithm.save_model-367"><a href="#AdversarialAlgorithm.save_model-367"><span class="linenos">367</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-368"><a href="#AdversarialAlgorithm.save_model-368"><span class="linenos">368</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-369"><a href="#AdversarialAlgorithm.save_model-369"><span class="linenos">369</span></a>
</span><span id="AdversarialAlgorithm.save_model-370"><a href="#AdversarialAlgorithm.save_model-370"><span class="linenos">370</span></a>            <span class="c1"># Saving discriminator model to JSON and weights</span>
</span><span id="AdversarialAlgorithm.save_model-371"><a href="#AdversarialAlgorithm.save_model-371"><span class="linenos">371</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving discriminator model...&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-372"><a href="#AdversarialAlgorithm.save_model-372"><span class="linenos">372</span></a>            <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm.save_model-373"><a href="#AdversarialAlgorithm.save_model-373"><span class="linenos">373</span></a>
</span><span id="AdversarialAlgorithm.save_model-374"><a href="#AdversarialAlgorithm.save_model-374"><span class="linenos">374</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.save_model-375"><a href="#AdversarialAlgorithm.save_model-375"><span class="linenos">375</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-376"><a href="#AdversarialAlgorithm.save_model-376"><span class="linenos">376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-377"><a href="#AdversarialAlgorithm.save_model-377"><span class="linenos">377</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Discriminator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.save_model-378"><a href="#AdversarialAlgorithm.save_model-378"><span class="linenos">378</span></a>                                                                                  <span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-379"><a href="#AdversarialAlgorithm.save_model-379"><span class="linenos">379</span></a>
</span><span id="AdversarialAlgorithm.save_model-380"><a href="#AdversarialAlgorithm.save_model-380"><span class="linenos">380</span></a>            <span class="c1"># Saving generator model to JSON and weights</span>
</span><span id="AdversarialAlgorithm.save_model-381"><a href="#AdversarialAlgorithm.save_model-381"><span class="linenos">381</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Saving generator model...&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-382"><a href="#AdversarialAlgorithm.save_model-382"><span class="linenos">382</span></a>            <span class="n">generator_model_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm.save_model-383"><a href="#AdversarialAlgorithm.save_model-383"><span class="linenos">383</span></a>
</span><span id="AdversarialAlgorithm.save_model-384"><a href="#AdversarialAlgorithm.save_model-384"><span class="linenos">384</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.save_model-385"><a href="#AdversarialAlgorithm.save_model-385"><span class="linenos">385</span></a>                <span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-386"><a href="#AdversarialAlgorithm.save_model-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-387"><a href="#AdversarialAlgorithm.save_model-387"><span class="linenos">387</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generator model saved at: </span><span class="si">{}</span><span class="s2">.json and </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">,</span>
</span><span id="AdversarialAlgorithm.save_model-388"><a href="#AdversarialAlgorithm.save_model-388"><span class="linenos">388</span></a>                                                                              <span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-389"><a href="#AdversarialAlgorithm.save_model-389"><span class="linenos">389</span></a>
</span><span id="AdversarialAlgorithm.save_model-390"><a href="#AdversarialAlgorithm.save_model-390"><span class="linenos">390</span></a>        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.save_model-391"><a href="#AdversarialAlgorithm.save_model-391"><span class="linenos">391</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file already exists. Aborting.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-392"><a href="#AdversarialAlgorithm.save_model-392"><span class="linenos">392</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.save_model-393"><a href="#AdversarialAlgorithm.save_model-393"><span class="linenos">393</span></a>
</span><span id="AdversarialAlgorithm.save_model-394"><a href="#AdversarialAlgorithm.save_model-394"><span class="linenos">394</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.save_model-395"><a href="#AdversarialAlgorithm.save_model-395"><span class="linenos">395</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while saving the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.save_model-396"><a href="#AdversarialAlgorithm.save_model-396"><span class="linenos">396</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.load_models" class="classattr">
                                        <input id="AdversarialAlgorithm.load_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">path_output</span>, </span><span class="param"><span class="n">k_fold</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.load_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.load_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.load_models-398"><a href="#AdversarialAlgorithm.load_models-398"><span class="linenos">398</span></a>    <span class="k">def</span> <span class="nf">load_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_output</span><span class="p">,</span> <span class="n">k_fold</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.load_models-399"><a href="#AdversarialAlgorithm.load_models-399"><span class="linenos">399</span></a>
</span><span id="AdversarialAlgorithm.load_models-400"><a href="#AdversarialAlgorithm.load_models-400"><span class="linenos">400</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.load_models-401"><a href="#AdversarialAlgorithm.load_models-401"><span class="linenos">401</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading Adversarial Model for fold </span><span class="si">{}</span><span class="s2">...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-402"><a href="#AdversarialAlgorithm.load_models-402"><span class="linenos">402</span></a>
</span><span id="AdversarialAlgorithm.load_models-403"><a href="#AdversarialAlgorithm.load_models-403"><span class="linenos">403</span></a>            <span class="c1"># Directory containing saved models</span>
</span><span id="AdversarialAlgorithm.load_models-404"><a href="#AdversarialAlgorithm.load_models-404"><span class="linenos">404</span></a>            <span class="n">path_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_output</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_models_saved_path</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-405"><a href="#AdversarialAlgorithm.load_models-405"><span class="linenos">405</span></a>
</span><span id="AdversarialAlgorithm.load_models-406"><a href="#AdversarialAlgorithm.load_models-406"><span class="linenos">406</span></a>            <span class="c1"># Filenames for the discriminator and generator models</span>
</span><span id="AdversarialAlgorithm.load_models-407"><a href="#AdversarialAlgorithm.load_models-407"><span class="linenos">407</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_discriminator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-408"><a href="#AdversarialAlgorithm.load_models-408"><span class="linenos">408</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_name_generator</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k_fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-409"><a href="#AdversarialAlgorithm.load_models-409"><span class="linenos">409</span></a>
</span><span id="AdversarialAlgorithm.load_models-410"><a href="#AdversarialAlgorithm.load_models-410"><span class="linenos">410</span></a>            <span class="c1"># Full paths to the model files</span>
</span><span id="AdversarialAlgorithm.load_models-411"><a href="#AdversarialAlgorithm.load_models-411"><span class="linenos">411</span></a>            <span class="n">discriminator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">discriminator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-412"><a href="#AdversarialAlgorithm.load_models-412"><span class="linenos">412</span></a>            <span class="n">generator_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_directory</span><span class="p">,</span> <span class="n">generator_file_name</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-413"><a href="#AdversarialAlgorithm.load_models-413"><span class="linenos">413</span></a>
</span><span id="AdversarialAlgorithm.load_models-414"><a href="#AdversarialAlgorithm.load_models-414"><span class="linenos">414</span></a>            <span class="c1"># Load discriminator model</span>
</span><span id="AdversarialAlgorithm.load_models-415"><a href="#AdversarialAlgorithm.load_models-415"><span class="linenos">415</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading discriminator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-416"><a href="#AdversarialAlgorithm.load_models-416"><span class="linenos">416</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.load_models-417"><a href="#AdversarialAlgorithm.load_models-417"><span class="linenos">417</span></a>                <span class="n">discriminator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm.load_models-418"><a href="#AdversarialAlgorithm.load_models-418"><span class="linenos">418</span></a>
</span><span id="AdversarialAlgorithm.load_models-419"><a href="#AdversarialAlgorithm.load_models-419"><span class="linenos">419</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">discriminator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-420"><a href="#AdversarialAlgorithm.load_models-420"><span class="linenos">420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">discriminator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-421"><a href="#AdversarialAlgorithm.load_models-421"><span class="linenos">421</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded discriminator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">discriminator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-422"><a href="#AdversarialAlgorithm.load_models-422"><span class="linenos">422</span></a>
</span><span id="AdversarialAlgorithm.load_models-423"><a href="#AdversarialAlgorithm.load_models-423"><span class="linenos">423</span></a>            <span class="c1"># Load generator model</span>
</span><span id="AdversarialAlgorithm.load_models-424"><a href="#AdversarialAlgorithm.load_models-424"><span class="linenos">424</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading generator model from: </span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-425"><a href="#AdversarialAlgorithm.load_models-425"><span class="linenos">425</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.load_models-426"><a href="#AdversarialAlgorithm.load_models-426"><span class="linenos">426</span></a>                <span class="n">generator_model_json</span> <span class="o">=</span> <span class="n">json_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="AdversarialAlgorithm.load_models-427"><a href="#AdversarialAlgorithm.load_models-427"><span class="linenos">427</span></a>
</span><span id="AdversarialAlgorithm.load_models-428"><a href="#AdversarialAlgorithm.load_models-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">model_from_json</span><span class="p">(</span><span class="n">generator_model_json</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-429"><a href="#AdversarialAlgorithm.load_models-429"><span class="linenos">429</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">generator_file_name</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-430"><a href="#AdversarialAlgorithm.load_models-430"><span class="linenos">430</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loaded generator weights from: </span><span class="si">{}</span><span class="s2">.h5&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">generator_file_name</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-431"><a href="#AdversarialAlgorithm.load_models-431"><span class="linenos">431</span></a>
</span><span id="AdversarialAlgorithm.load_models-432"><a href="#AdversarialAlgorithm.load_models-432"><span class="linenos">432</span></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.load_models-433"><a href="#AdversarialAlgorithm.load_models-433"><span class="linenos">433</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Model file not found. Please provide an existing and valid model.&quot;</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-434"><a href="#AdversarialAlgorithm.load_models-434"><span class="linenos">434</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdversarialAlgorithm.load_models-435"><a href="#AdversarialAlgorithm.load_models-435"><span class="linenos">435</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="AdversarialAlgorithm.load_models-436"><a href="#AdversarialAlgorithm.load_models-436"><span class="linenos">436</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error occurred while loading the models: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="AdversarialAlgorithm.load_models-437"><a href="#AdversarialAlgorithm.load_models-437"><span class="linenos">437</span></a>            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_generator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_generator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_generator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">generator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_generator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_generator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_generator-439"><a href="#AdversarialAlgorithm.set_generator-439"><span class="linenos">439</span></a>    <span class="k">def</span> <span class="nf">set_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_generator-440"><a href="#AdversarialAlgorithm.set_generator-440"><span class="linenos">440</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generator</span> <span class="o">=</span> <span class="n">generator</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_discriminator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_discriminator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_discriminator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">discriminator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_discriminator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_discriminator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_discriminator-442"><a href="#AdversarialAlgorithm.set_discriminator-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">set_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_discriminator-443"><a href="#AdversarialAlgorithm.set_discriminator-443"><span class="linenos">443</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_discriminator</span> <span class="o">=</span> <span class="n">discriminator</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_latent_dimension" class="classattr">
                                        <input id="AdversarialAlgorithm.set_latent_dimension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_latent_dimension</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">latent_dimension</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_latent_dimension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_latent_dimension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_latent_dimension-445"><a href="#AdversarialAlgorithm.set_latent_dimension-445"><span class="linenos">445</span></a>    <span class="k">def</span> <span class="nf">set_latent_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latent_dimension</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_latent_dimension-446"><a href="#AdversarialAlgorithm.set_latent_dimension-446"><span class="linenos">446</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_latent_dimension</span> <span class="o">=</span> <span class="n">latent_dimension</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_optimizer_generator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_optimizer_generator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_optimizer_generator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">optimizer_generator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_optimizer_generator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_optimizer_generator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_optimizer_generator-448"><a href="#AdversarialAlgorithm.set_optimizer_generator-448"><span class="linenos">448</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_optimizer_generator-449"><a href="#AdversarialAlgorithm.set_optimizer_generator-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_generator</span> <span class="o">=</span> <span class="n">optimizer_generator</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_optimizer_discriminator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_optimizer_discriminator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_optimizer_discriminator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">optimizer_discriminator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_optimizer_discriminator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_optimizer_discriminator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_optimizer_discriminator-451"><a href="#AdversarialAlgorithm.set_optimizer_discriminator-451"><span class="linenos">451</span></a>    <span class="k">def</span> <span class="nf">set_optimizer_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_optimizer_discriminator-452"><a href="#AdversarialAlgorithm.set_optimizer_discriminator-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer_discriminator</span> <span class="o">=</span> <span class="n">optimizer_discriminator</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_loss_generator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_loss_generator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_loss_generator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">loss_generator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_loss_generator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_loss_generator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_loss_generator-454"><a href="#AdversarialAlgorithm.set_loss_generator-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">set_loss_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_generator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_loss_generator-455"><a href="#AdversarialAlgorithm.set_loss_generator-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_generator</span> <span class="o">=</span> <span class="n">loss_generator</span>
</span></pre></div>


    

                            </div>
                            <div id="AdversarialAlgorithm.set_loss_discriminator" class="classattr">
                                        <input id="AdversarialAlgorithm.set_loss_discriminator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_loss_discriminator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">loss_discriminator</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdversarialAlgorithm.set_loss_discriminator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdversarialAlgorithm.set_loss_discriminator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdversarialAlgorithm.set_loss_discriminator-457"><a href="#AdversarialAlgorithm.set_loss_discriminator-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">set_loss_discriminator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_discriminator</span><span class="p">):</span>
</span><span id="AdversarialAlgorithm.set_loss_discriminator-458"><a href="#AdversarialAlgorithm.set_loss_discriminator-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_loss_discriminator</span> <span class="o">=</span> <span class="n">loss_discriminator</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
</body>
</html>